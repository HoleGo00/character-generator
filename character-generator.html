<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ËßíËâ≤ÁîüÊàêÂô®</title>

    <!-- 
          ============================= Â§ö‰∏ñÁïåËÉåÊôØÈ¢úËâ≤ÈÖçÁΩÆ =============================
          
          üé® Âø´ÈÄü‰øÆÊîπËØ¥ÊòéÔºö
          1. ÊÉ≥Ë¶ÅÊîπÂèòÊï¥‰Ωì‰∏ªÈ¢òËâ≤Ôºü ‚Üí ‰øÆÊîπ --primary-color„ÄÅ--primary-dark„ÄÅ--primary-darker
          2. ÊÉ≥Ë¶ÅÊîπÂèòÊñáÂ≠óÈ¢úËâ≤Ôºü   ‚Üí ‰øÆÊîπ --secondary-color  
          3. ÊÉ≥Ë¶ÅÊîπÂèòÈù¢ÊùøÈ¢úËâ≤Ôºü   ‚Üí ‰øÆÊîπ --panel-bg
          4. ÊÉ≥Ë¶ÅÊîπÂèòÊèêÁ§∫È¢úËâ≤Ôºü   ‚Üí ‰øÆÊîπ --success-color„ÄÅ--error-color Á≠â
          
          üé® ËØ¶ÁªÜËØ¥ÊòéÔºö
          --primary-color: ‰∏ªËâ≤Ë∞É (#313a3d) ‚Üí È°µÈù¢ËÉåÊôØÊ∏êÂèò„ÄÅÈÄâ‰∏≠Áä∂ÊÄÅÊñáÂ≠óËâ≤
          --primary-dark: Ê∑±Ëâ≤Ë∞É (#2a3235) ‚Üí È°µÈù¢ËÉåÊôØÊ∏êÂèò‰∏≠Èó¥Ëâ≤  
          --primary-darker: Êõ¥Ê∑±Ëâ≤ (#212a2d) ‚Üí È°µÈù¢ËÉåÊôØÊ∏êÂèòÂ∫ïËâ≤
          --secondary-color: ËæÖÂä©Ëâ≤ (#ebd7d7) ‚Üí ‰∏ªË¶ÅÊñáÂ≠óÈ¢úËâ≤„ÄÅÊåâÈíÆËæπÊ°ÜËâ≤
          --panel-bg: Èù¢ÊùøËâ≤ (#313a3d) ‚Üí ÊâÄÊúâËæìÂÖ•Ê°Ü„ÄÅÈÄâÊã©Ê°Ü„ÄÅÊåâÈíÆËÉåÊôØËâ≤
          --success-color: ÊàêÂäüËâ≤ (#4ade80) ‚Üí ÊàêÂäüÊèêÁ§∫ÊñáÂ≠óÈ¢úËâ≤
          --error-color: ÈîôËØØËâ≤ (#f87171) ‚Üí ÈîôËØØÊèêÁ§∫„ÄÅË≠¶ÂëäËæπÊ°ÜÈ¢úËâ≤  
          --muted-color: ÈùôÈü≥Ëâ≤ (#a1a1aa) ‚Üí Á¶ÅÁî®Áä∂ÊÄÅÊñáÂ≠óÈ¢úËâ≤
          --accent-color: Âº∫Ë∞ÉËâ≤ (#c084fc) ‚Üí ÁâπÊÆäÊ†áËÆ∞„ÄÅÈ´ò‰∫ÆÈ¢úËâ≤
          
          üí° ‰øÆÊîπÊèêÁ§∫ÔºöÁõ¥Êé•ÊõøÊç¢È¢úËâ≤‰ª£Á†ÅÂç≥ÂèØÔºåÂ¶Ç #ff0000(Á∫¢Ëâ≤) #00ff00(ÁªøËâ≤) #0000ff(ËìùËâ≤)
          ========================================================================
          -->
    <style>
      :root {
        /* ‰∏ªË¶ÅÈ¢úËâ≤ - Â∞ÜÁî±JavaScriptÊ†πÊçÆ‰∏ñÁïåËÉåÊôØÂä®ÊÄÅËÆæÁΩÆ */
        --primary-color: #313a3d;
        --primary-dark: #2a3235;
        --primary-darker: #212a2d;
        --secondary-color: #ebd7d7;

        /* Èù¢ÊùøÈ¢úËâ≤ */
        --panel-bg: #313a3d;
        --panel-bg-opacity: 0.9;

        /* ÂäüËÉΩÈ¢úËâ≤ */
        --success-color: #4ade80;
        --error-color: #f87171;
        --muted-color: #a1a1aa;
        --accent-color: #c084fc;

        /* Ëá™Âä®ËÆ°ÁÆóÁöÑÈÄèÊòéÂ∫¶È¢úËâ≤ÔºàËØ∑Âãø‰øÆÊîπÔºâ */
        --primary-opacity-10: rgba(49, 58, 61, 0.1);
        --primary-opacity-20: rgba(49, 58, 61, 0.2);
        --primary-opacity-30: rgba(49, 58, 61, 0.3);
        --primary-opacity-40: rgba(49, 58, 61, 0.4);
        --secondary-opacity-10: rgba(235, 215, 215, 0.1);
        --secondary-opacity-20: rgba(235, 215, 215, 0.2);
        --secondary-opacity-30: rgba(235, 215, 215, 0.3);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
        background: linear-gradient(
          135deg,
          var(--primary-color) 0%,
          var(--primary-dark) 50%,
          var(--primary-darker) 100%
        );
        color: var(--secondary-color);
        position: relative;
        overflow-x: hidden;
        padding: 20px 0;
      }

      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
      }

      /* Ë£ÖÈ•∞ÊÄßÊòüÊòü */
      .star {
        position: absolute;
        color: var(--secondary-color);
        font-size: 16px;
        opacity: 0.6;
        animation: twinkle 2s infinite;
      }

      .star:nth-child(1) {
        top: 12%;
        left: 8%;
        animation-delay: 0s;
      }
      .star:nth-child(2) {
        top: 22%;
        right: 12%;
        animation-delay: 0.5s;
      }
      .star:nth-child(3) {
        top: 55%;
        left: 6%;
        animation-delay: 1s;
      }
      .star:nth-child(4) {
        bottom: 18%;
        right: 8%;
        animation-delay: 1.5s;
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.3;
        }
        50% {
          opacity: 0.8;
        }
      }

      /* CSSÂõæÊ†áÊ†∑Âºè */
      .crown-icon {
        display: inline-block;
        width: 16px;
        height: 16px;
        margin-right: 8px;
        position: relative;
      }

      .crown-icon::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 14px;
        height: 10px;
        border: 2px solid var(--secondary-color);
        border-bottom: 3px solid var(--secondary-color);
        border-radius: 2px 2px 0 0;
      }

      .crown-icon::after {
        content: '';
        position: absolute;
        top: 30%;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        border-bottom: 6px solid var(--secondary-color);
      }

      .dice-icon {
        display: inline-block;
        margin-left: 8px;
        font-size: 16px;
        color: var(--secondary-color);
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.3s;
      }

      .dice-icon:hover {
        opacity: 1;
      }

      .edit-icon {
        display: inline-block;
        margin-left: 5px;
        font-size: 16px;
        color: var(--secondary-color);
        cursor: pointer;
        opacity: 0.7;
        transition: opacity 0.3s;
      }

      .edit-icon:hover {
        opacity: 1;
      }

      .main-panel {
        background: rgba(49, 58, 61, var(--panel-bg-opacity));
        border: 2px solid var(--secondary-color);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 0 30px var(--secondary-opacity-30);
        backdrop-filter: blur(10px);
      }

      .title {
        text-align: center;
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 15px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        font-size: 14px;
        line-height: 1.6;
        text-align: center;
        margin-bottom: 20px;
        opacity: 0.9;
        padding: 0 10px;
      }

      .form-section {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
      }

      .form-group.full-width {
        grid-column: 1 / -1;
      }

      .form-label {
        display: flex;
        align-items: center;
        margin-bottom: 5px;
        font-size: 14px;
        font-weight: bold;
      }

      .form-label .icon {
        margin-left: 8px;
        cursor: pointer;
        opacity: 0.7;
        font-size: 16px;
      }

      .form-label .icon:hover {
        opacity: 1;
      }

      .form-input,
      .form-select {
        padding: 8px 12px;
        border: 1px solid var(--secondary-color);
        border-radius: 8px;
        background: rgba(49, 58, 61, 0.8);
        color: var(--secondary-color);
        font-size: 14px;
      }

      .form-input:focus,
      .form-select:focus {
        outline: none;
        border-color: #fff;
        box-shadow: 0 0 8px var(--secondary-opacity-30);
      }

      .custom-input {
        display: none;
        margin-top: 5px;
      }

      .custom-input.show {
        display: block;
      }

      .options-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 8px;
        margin-top: 5px;
      }

      .option-btn {
        padding: 6px 10px;
        border: 1px solid var(--secondary-color);
        border-radius: 15px;
        background: rgba(49, 58, 61, 0.8);
        color: var(--secondary-color);
        font-size: 12px;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s;
      }

      .option-btn.selected {
        background: var(--secondary-color);
        color: var(--primary-color);
        font-weight: bold;
      }

      .option-btn:hover {
        background: var(--secondary-opacity-20);
      }

      .bottom-actions {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
      }

      .action-btn {
        padding: 12px 25px;
        border: 2px solid var(--secondary-color);
        border-radius: 25px;
        background: rgba(49, 58, 61, 0.8);
        color: var(--secondary-color);
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .action-btn:hover {
        background: var(--secondary-color);
        color: var(--primary-color);
        transform: translateY(-2px);
        box-shadow: 0 5px 15px var(--secondary-opacity-30);
      }

      .action-btn.primary {
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        color: var(--primary-color);
      }

      .action-btn.primary:hover {
        background: linear-gradient(45deg, #fff, var(--secondary-color));
      }

      .completion-text {
        text-align: center;
        margin-top: 15px;
        font-size: 14px;
        opacity: 0.8;
      }

      .top-actions {
        margin-bottom: 20px;
        margin-top: 10px;
      }

      /* Ë∞ÉÊï¥ÂÖ∂‰ªñËá™ÂÆö‰πâËæìÂÖ•Ê°ÜÂÆΩÂ∫¶ */
      .other-custom-section .form-input {
        width: 100%;
      }

      /* ÊäòÂè†ÈÄâÈ°πÊ†∑Âºè */
      .collapsible-section {
        margin-bottom: 15px;
      }

      .collapsible-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        cursor: pointer;
        padding: 8px 12px;
        border: 1px solid var(--secondary-color);
        border-radius: 8px;
        background: rgba(49, 58, 61, 0.8);
        margin-bottom: 5px;
        transition: all 0.3s;
      }

      .collapsible-header:hover {
        background: var(--secondary-opacity-10);
      }

      .collapsible-header.collapsed .expand-icon {
        transform: rotate(-90deg);
      }

      .expand-icon {
        font-size: 14px;
        color: var(--secondary-color);
        transition: transform 0.3s;
      }

      .collapsible-content {
        max-height: 500px;
        overflow-y: auto;
        overflow-x: hidden;
        transition: max-height 0.3s ease-out;
      }

      .collapsible-content.collapsed {
        max-height: 0;
        overflow: hidden;
      }

      .selected-items {
        display: none;
        flex-wrap: wrap;
        gap: 5px;
        margin-top: 5px;
      }

      .selected-items.show {
        display: flex;
      }

      .selected-item {
        padding: 3px 8px;
        background: var(--secondary-color);
        color: var(--primary-color);
        border-radius: 10px;
        font-size: 11px;
        font-weight: bold;
      }

      /* ÂçïÈÄâÊ®°ÂºèÊ†∑Âºè */
      .single-select .option-btn.selected {
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        color: var(--primary-color);
        font-weight: bold;
        box-shadow: 0 2px 8px var(--secondary-opacity-40);
      }

      .single-select .option-btn:not(.selected):hover {
        background: var(--secondary-opacity-10);
      }

      /* Á≥ªÁªüÂéüÂõ†ÈÄâÈ°πÊ†∑Âºè */
      .system-reason-option {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        text-align: left;
        padding: 12px 15px;
        min-height: auto;
        line-height: 1.4;
      }

      .system-reason-title {
        font-weight: bold;
        font-size: 14px;
        margin-bottom: 6px;
        color: var(--secondary-color);
      }

      .system-reason-desc {
        font-size: 11px;
        color: var(--secondary-color);
        opacity: 0.8;
        margin-bottom: 6px;
        line-height: 1.3;
      }

      .system-reason-balance {
        font-size: 12px;
        font-weight: bold;
        color: #fff;
        background: var(--secondary-opacity-20);
        padding: 2px 8px;
        border-radius: 8px;
        align-self: flex-end;
      }

      .system-reason-balance.positive {
        color: var(--success-color);
      }

      .system-reason-balance.negative {
        color: var(--error-color);
      }

      .system-reason-balance.zero {
        color: var(--muted-color);
      }

      /* Á≥ªÁªüÂéüÂõ†ÈÄâÈ°πÈÄâ‰∏≠Áä∂ÊÄÅÁöÑÁâπÊÆäÊ†∑Âºè */
      .system-reason-option.selected {
        border: 2px solid var(--secondary-color);
        box-shadow: 0 4px 12px var(--secondary-opacity-30);
      }

      .system-reason-option.selected .system-reason-title {
        color: #fff;
      }

      .system-reason-option.selected .system-reason-desc {
        opacity: 1;
        color: var(--accent-color);
      }

      .system-reason-option.selected .system-reason-balance {
        background: var(--secondary-opacity-40);
        box-shadow: 0 2px 4px var(--secondary-opacity-20);
      }

      /* Â±ûÊÄßÂä†ÁÇπÊ†∑Âºè */
      .attribute-item {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        gap: 15px;
      }

      .attribute-label {
        flex: 0 0 100px;
        font-size: 14px;
        font-weight: bold;
        color: var(--secondary-color);
      }

      .attribute-controls {
        flex: 1;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .attribute-slider {
        flex: 1;
        height: 6px;
        border-radius: 3px;
        background: linear-gradient(to right, var(--secondary-opacity-30), var(--primary-opacity-30));
        outline: none;
        opacity: 0.7;
        transition: opacity 0.2s;
        cursor: pointer;
        -webkit-appearance: none;
        appearance: none;
      }

      .attribute-slider::-webkit-slider-track {
        height: 6px;
        border-radius: 3px;
        background: linear-gradient(to right, var(--secondary-opacity-30), var(--primary-opacity-30));
      }

      .attribute-slider::-moz-range-track {
        height: 6px;
        border-radius: 3px;
        background: linear-gradient(to right, var(--secondary-opacity-30), var(--primary-opacity-30));
        border: none;
      }

      .attribute-slider:hover {
        opacity: 1;
      }

      .attribute-slider::-webkit-slider-thumb {
        appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        cursor: pointer;
        box-shadow: 0 2px 6px var(--secondary-opacity-30);
      }

      .attribute-slider::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 6px var(--secondary-opacity-30);
      }

      .attribute-input {
        width: 50px;
        padding: 4px 8px;
        border: 1px solid var(--secondary-color);
        border-radius: 4px;
        background: rgba(49, 58, 61, 0.8);
        color: var(--secondary-color);
        font-size: 12px;
        text-align: center;
      }

      .attribute-input:focus {
        outline: none;
        border-color: #fff;
        box-shadow: 0 0 4px var(--secondary-opacity-30);
      }

      .attribute-subtitle {
        font-size: 12px;
        color: var(--secondary-color);
        opacity: 0.8;
        margin-bottom: 15px;
        text-align: center;
        font-style: italic;
      }

      /* ËØ¥ÊòéÈ°µÈù¢Ê†∑Âºè */
      .instruction-panel {
        text-align: center;
        min-height: 600px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        position: relative;
      }

      .instruction-content {
        padding: 20px;
      }

      .important-steps {
        margin-bottom: 40px;
      }

      .step-item {
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 20px 0;
        padding: 15px 25px;
        border-radius: 15px;
        border: 2px solid;
        background: rgba(49, 58, 61, 0.8);
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
      }

      .step-item.urgent {
        border-color: var(--secondary-color);
        box-shadow: 0 0 20px var(--secondary-opacity-40);
        animation: urgentGlow 2s ease-in-out infinite alternate;
      }

      .step-item.warning {
        border-color: var(--error-color);
        box-shadow: 0 0 15px rgba(248, 113, 113, 0.3);
      }

      @keyframes urgentGlow {
        from {
          box-shadow: 0 0 20px var(--secondary-opacity-40);
        }
        to {
          box-shadow: 0 0 30px var(--primary-opacity-30);
        }
      }

      .step-number {
        width: 35px;
        height: 35px;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        color: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 18px;
        margin-right: 15px;
        flex-shrink: 0;
      }

      .step-icon {
        font-size: 24px;
        margin-right: 15px;
        flex-shrink: 0;
      }

      .step-text {
        font-size: 16px;
        font-weight: 500;
        color: var(--secondary-color);
        text-align: left;
        line-height: 1.4;
      }

      .step-text strong {
        color: #fff;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: bold;
        font-size: 18px;
      }

      .thank-you-section {
        margin: 40px 0;
        padding: 25px;
        border: 1px solid var(--secondary-opacity-30);
        border-radius: 15px;
        background: var(--secondary-opacity-10);
      }

      .thank-you-text p {
        margin: 8px 0;
        font-size: 16px;
        color: var(--secondary-color);
        opacity: 0.9;
      }

      .author-signature {
        margin-top: 25px;
        padding-top: 20px;
        border-top: 1px solid var(--secondary-opacity-30);
      }

      .signature-text {
        font-size: 18px;
        font-weight: bold;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .decoration-stars {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: -1;
      }

      .star-decoration {
        position: absolute;
        font-size: 20px;
        color: var(--secondary-color);
        opacity: 0.6;
        animation: twinkle 3s infinite;
      }

      .star-decoration:nth-child(1) {
        top: 15%;
        left: 10%;
        animation-delay: 0s;
      }

      .star-decoration:nth-child(2) {
        top: 25%;
        right: 15%;
        animation-delay: 0.6s;
      }

      .star-decoration:nth-child(3) {
        top: 60%;
        left: 8%;
        animation-delay: 1.2s;
      }

      .star-decoration:nth-child(4) {
        bottom: 20%;
        right: 12%;
        animation-delay: 1.8s;
      }

      .star-decoration:nth-child(5) {
        bottom: 30%;
        left: 20%;
        animation-delay: 2.4s;
      }

      /* ÂìçÂ∫îÂºèËÆæËÆ° */
      @media (max-width: 600px) {
        body {
          padding: 10px 0;
        }

        .container {
          padding: 15px;
        }

        .form-section {
          grid-template-columns: 1fr;
        }

        .bottom-actions,
        .top-actions {
          flex-direction: column;
          align-items: center;
        }

        .options-grid {
          grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        }

        .attribute-item {
          flex-direction: column;
          align-items: stretch;
          gap: 8px;
        }

        .attribute-label {
          flex: none;
          text-align: center;
        }

        .attribute-controls {
          justify-content: center;
        }

        .system-reason-option {
          margin-bottom: 10px;
        }

        .system-reason-desc {
          font-size: 10px;
          margin-bottom: 4px;
        }

        .system-reason-balance {
          font-size: 11px;
          padding: 1px 6px;
        }

        /* ËØ¥ÊòéÈ°µÈù¢ÂìçÂ∫îÂºè */
        .instruction-panel {
          min-height: 500px;
          padding: 15px;
        }

        .step-item {
          margin: 15px 0;
          padding: 12px 20px;
          flex-direction: column;
          text-align: center;
        }

        .step-number {
          width: 30px;
          height: 30px;
          font-size: 16px;
          margin-right: 0;
          margin-bottom: 8px;
        }

        .step-icon {
          margin-right: 0;
          margin-bottom: 8px;
        }

        .step-text {
          font-size: 14px;
          text-align: center;
        }

        .step-text strong {
          font-size: 16px;
        }

        .thank-you-section {
          margin: 30px 0;
          padding: 20px;
        }

        .signature-text {
          font-size: 16px;
        }
      }

      /* YAMLÊ®°ÊÄÅÁ™óÂè£Ê†∑Âºè */
      .yaml-modal {
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        backdrop-filter: blur(5px);
      }

      .yaml-modal-content {
        background: var(--panel-bg);
        margin: 5% auto;
        padding: 0;
        border: 2px solid var(--secondary-color);
        border-radius: 20px;
        width: 90%;
        max-width: 800px;
        max-height: 80vh;
        overflow: hidden;
        box-shadow: 0 0 30px var(--secondary-opacity-30);
        backdrop-filter: blur(10px);
      }

      .yaml-modal-header {
        padding: 20px 25px;
        border-bottom: 1px solid var(--secondary-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(49, 58, 61, var(--panel-bg-opacity));
      }

      .yaml-modal-header h2 {
        margin: 0;
        color: var(--secondary-color);
        font-size: 20px;
        font-weight: bold;
        background: linear-gradient(45deg, var(--secondary-color), #fff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .yaml-modal-close {
        color: var(--secondary-color);
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        line-height: 1;
        transition: all 0.3s;
      }

      .yaml-modal-close:hover {
        color: #fff;
        transform: scale(1.1);
      }

      .yaml-modal-body {
        padding: 20px 25px;
        background: rgba(49, 58, 61, var(--panel-bg-opacity));
      }

      #yamlOutput {
        width: 100%;
        height: 400px;
        background: rgba(49, 58, 61, 0.8);
        border: 1px solid var(--secondary-color);
        border-radius: 8px;
        color: var(--secondary-color);
        font-family: 'Courier New', monospace;
        font-size: 14px;
        padding: 15px;
        resize: vertical;
        margin-bottom: 15px;
        line-height: 1.4;
      }

      #yamlOutput:focus {
        outline: none;
        border-color: #fff;
        box-shadow: 0 0 8px var(--secondary-opacity-30);
      }

      .yaml-modal-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
      }

      .yaml-modal-actions .action-btn {
        min-width: 150px;
      }

      /* ÂìçÂ∫îÂºèËÆæËÆ° - YAMLÊ®°ÊÄÅÁ™óÂè£ */
      @media (max-width: 600px) {
        .yaml-modal-content {
          margin: 10% auto;
          width: 95%;
          max-height: 85vh;
        }

        .yaml-modal-header {
          padding: 15px 20px;
        }

        .yaml-modal-header h2 {
          font-size: 18px;
        }

        .yaml-modal-close {
          font-size: 24px;
        }

        .yaml-modal-body {
          padding: 15px 20px;
        }

        #yamlOutput {
          height: 300px;
          font-size: 12px;
          padding: 10px;
        }

        .yaml-modal-actions {
          flex-direction: column;
          align-items: center;
        }

        .yaml-modal-actions .action-btn {
          width: 100%;
          min-width: auto;
        }
      }

      /* Â≠óÊÆµÈ™åËØÅÈîôËØØÊ†∑Âºè */
      .form-group.error .form-input,
      .form-group.error .form-select {
        border-color: var(--error-color);
        box-shadow: 0 0 8px rgba(248, 113, 113, 0.3);
      }

      .field-error {
        color: var(--error-color);
        font-size: 12px;
        margin-top: 5px;
        display: none;
      }

      .form-group.error .field-error {
        display: block;
      }

      .required-indicator {
        color: var(--error-color);
        margin-left: 2px;
        font-weight: bold;
      }

      /* ËøîÂõûÊåâÈíÆÊ†∑Âºè */
      .back-btn {
        position: fixed;
        top: 20px;
        left: 20px;
        background: rgba(49, 58, 61, var(--panel-bg-opacity));
        border: 2px solid var(--secondary-color);
        border-radius: 15px;
        padding: 10px 20px;
        color: var(--secondary-color);
        text-decoration: none;
        font-weight: bold;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        z-index: 1000;
        box-shadow: 0 2px 10px var(--secondary-opacity-20);
      }

      .back-btn:hover {
        background: var(--secondary-color);
        color: var(--primary-color);
        transform: translateX(-5px);
      }

      /* ‰∏ñÁïåËÉåÊôØÊòæÁ§∫Ê†∑Âºè */
      .world-header {
        text-align: center;
        margin-bottom: 20px;
        padding: 15px;
        border: 2px solid var(--secondary-color);
        border-radius: 15px;
        background: rgba(49, 58, 61, 0.3);
        backdrop-filter: blur(5px);
      }

      .world-icon {
        font-size: 32px;
        margin-right: 10px;
        filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
      }

      .world-name {
        font-size: 24px;
        font-weight: bold;
        color: var(--secondary-color);
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      }
    </style>
  </head>
  <body>
    <!-- ËøîÂõûÊåâÈíÆ -->
    <a href="index.html" class="back-btn" id="backBtn">‚Üê ËøîÂõû‰∏ñÁïåÈÄâÊã©</a>
    
    <div class="star">‚ú®</div>
    <div class="star">‚≠ê</div>
    <div class="star">‚ú®</div>
    <div class="star">‚≠ê</div>

    <div class="container">
      <div class="main-panel">
        <!-- ‰∏ñÁïåËÉåÊôØÊòæÁ§∫ -->
        <div class="world-header" id="worldHeader">
          <span class="world-icon" id="worldIcon">üèôÔ∏è</span>
          <span class="world-name" id="worldName">Áé∞‰ª£ÈÉΩÂ∏Ç</span>
        </div>
        
        <h1 class="title" id="pageTitle">‚ú® ËßíËâ≤ÁîüÊàêÂô® ‚ú®</h1>

        <!-- È°∂ÈÉ®Âø´Êç∑ÊåâÈíÆ -->
        <div class="bottom-actions top-actions">
          <button class="action-btn" onclick="randomizeAll()">üìö ÈöèÊú∫ÁîüÊàêÂÖ®ÈÉ®</button>
          <button class="action-btn primary" onclick="confirmCreate()">‚ú® ÁîüÊàêËßíËâ≤Êï∞ÊçÆ ‚ú®</button>
        </div>

        <!-- Âü∫Êú¨‰ø°ÊÅØ -->
        <div class="form-section">
          <div class="form-group full-width">
            <div class="form-label">
              <span class="crown-icon"></span>
              Ê†∏ÂøÉË∫´‰ªΩ‰ø°ÊÅØ
            </div>
          </div>

          <div class="form-group">
            <div class="form-label">
              ÂßìÂêç<span class="required-indicator">*</span>
              <span class="icon edit-icon" onclick="editCustom('realName')">üñã</span>
            </div>
            <input type="text" class="form-input" id="realName" placeholder="ËæìÂÖ•Áî®Êà∑ÂßìÂêç" />
            <div class="field-error" id="realNameError">ËØ∑ËæìÂÖ•ÂßìÂêçÔºåËøôÊòØÂøÖÂ°´È°π</div>
            <input type="text" class="form-input custom-input" id="realNameCustom" placeholder="Ëá™ÂÆö‰πâÂßìÂêç" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Âπ¥ÈæÑ
              <span class="icon dice-icon" onclick="randomizeField('age')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('age')">üñã</span>
            </div>
            <input type="number" class="form-input" id="age" placeholder="ËæìÂÖ•Âπ¥ÈæÑ" />
            <input type="text" class="form-input custom-input" id="ageCustom" placeholder="Ëá™ÂÆö‰πâÂπ¥ÈæÑ" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ÁîüÁêÜÊÄßÂà´
              <span class="icon dice-icon" onclick="randomizeField('biologicalGender')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('biologicalGender')">üñã</span>
            </div>
            <select class="form-select" id="biologicalGender">
              <option value="">ÈÄâÊã©ÊÄßÂà´</option>
              <option value="Â•≥">Â•≥</option>
              <option value="Áî∑">Áî∑</option>
              <option value="Êâ∂Â•π">Êâ∂Â•π</option>
              <option value="ÂèåÊÄß">ÂèåÊÄß</option>
              <option value="Êó†ÊÄß">Êó†ÊÄß</option>
            </select>
            <input
              type="text"
              class="form-input custom-input"
              id="biologicalGenderCustom"
              placeholder="Ëá™ÂÆö‰πâÁîüÁêÜÊÄßÂà´"
            />
          </div>

          <div class="form-group">
            <div class="form-label">
              ÊÄßÂèñÂêë
              <span class="icon dice-icon" onclick="randomizeField('sexualOrientation')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('sexualOrientation')">üñã</span>
            </div>
            <select class="form-select" id="sexualOrientation">
              <option value="">ÈÄâÊã©ÊÄßÂèñÂêë</option>
              <option value="ÂºÇÊÄßÊÅã">ÂºÇÊÄßÊÅã</option>
              <option value="ÂêåÊÄßÊÅã">ÂêåÊÄßÊÅã</option>
              <option value="ÂõõÁà±">ÂõõÁà±</option>
              <option value="ÂèåÊÄßÊÅã">ÂèåÊÄßÊÅã</option>
              <option value="Ê≥õÊÄßÊÅã">Ê≥õÊÄßÊÅã</option>
              <option value="Êó†Áà±ËÄÖ">Êó†Áà±ËÄÖ</option>
              <option value="Êó†ÊÄßÊÅã">Êó†ÊÄßÊÅã</option>
            </select>
            <input
              type="text"
              class="form-input custom-input"
              id="sexualOrientationCustom"
              placeholder="Ëá™ÂÆö‰πâÊÄßÂèñÂêë"
            />
          </div>

          <!-- Ê≠£Èù¢ÊÄßÊ†º -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="positiveTraitsSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('positiveTraits')">
                <div>
                  <span>Ê≠£Èù¢ÊÄßÊ†º</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('positiveTraits')"
                    >‚öÖ</span
                  >
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('positiveTraits')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="positiveTraitsSelected"></div>
              <div class="collapsible-content collapsed" id="positiveTraitsContent">
                <div class="options-grid" id="positiveTraitsGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="positiveTraitsCustom"
                  placeholder="Ëá™ÂÆö‰πâÊ≠£Èù¢ÊÄßÊ†ºÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- Ë¥üÈù¢ÊÄßÊ†º -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="negativeTraitsSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('negativeTraits')">
                <div>
                  <span>Ë¥üÈù¢ÊÄßÊ†º</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('negativeTraits')"
                    >‚öÖ</span
                  >
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('negativeTraits')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="negativeTraitsSelected"></div>
              <div class="collapsible-content collapsed" id="negativeTraitsContent">
                <div class="options-grid" id="negativeTraitsGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="negativeTraitsCustom"
                  placeholder="Ëá™ÂÆö‰πâË¥üÈù¢ÊÄßÊ†ºÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- ÊÑüÊÉÖËßÇ -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="loveViewsSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('loveViews')">
                <div>
                  <span>ÊÑüÊÉÖËßÇ</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('loveViews')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('loveViews')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="loveViewsSelected"></div>
              <div class="collapsible-content collapsed" id="loveViewsContent">
                <div class="options-grid" id="loveViewsGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="loveViewsCustom"
                  placeholder="Ëá™ÂÆö‰πâÊÑüÊÉÖËßÇÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- Á§æ‰∫§È£éÊ†º -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="socialStyleSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('socialStyle')">
                <div>
                  <span>Á§æ‰∫§È£éÊ†º</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('socialStyle')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('socialStyle')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="socialStyleSelected"></div>
              <div class="collapsible-content collapsed" id="socialStyleContent">
                <div class="options-grid" id="socialStyleGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="socialStyleCustom"
                  placeholder="Ëá™ÂÆö‰πâÁ§æ‰∫§È£éÊ†ºÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Â§ñË≤åËÆæÂÆö -->
        <div class="form-section">
          <div class="form-group full-width">
            <div class="form-label">
              <span class="crown-icon"></span>
              Â§ñË≤åËÆæÂÆö
            </div>
          </div>

          <div class="form-group">
            <div class="form-label">
              Ë∫´È´ò
              <span class="icon dice-icon" onclick="randomizeField('height')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('height')">üñã</span>
            </div>
            <input type="number" class="form-input" id="height" placeholder="ËæìÂÖ•Ë∫´È´ò" />
            <div style="font-size: 12px; color: var(--secondary-color); opacity: 0.7; margin-top: 2px">cm</div>
            <input type="text" class="form-input custom-input" id="heightCustom" placeholder="Ëá™ÂÆö‰πâË∫´È´ò" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ‰ΩìÈáç
              <span class="icon dice-icon" onclick="randomizeField('weight')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('weight')">üñã</span>
            </div>
            <input type="number" class="form-input" id="weight" placeholder="ËæìÂÖ•‰ΩìÈáç" />
            <div style="font-size: 12px; color: var(--secondary-color); opacity: 0.7; margin-top: 2px">kg</div>
            <input type="text" class="form-input custom-input" id="weightCustom" placeholder="Ëá™ÂÆö‰πâ‰ΩìÈáç" />
          </div>

          <!-- Èù¢Ë≤å -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="faceSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('face')">
                <div>
                  <span>Èù¢Ë≤å</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('face')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('face')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="faceSelected"></div>
              <div class="collapsible-content collapsed" id="faceContent">
                <div class="options-grid" id="faceGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="faceCustom"
                  placeholder="Ëá™ÂÆö‰πâÈù¢Ë≤åÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- Ë∫´Êùê -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="bodySection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('body')">
                <div>
                  <span>Ë∫´Êùê</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('body')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('body')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="bodySelected"></div>
              <div class="collapsible-content collapsed" id="bodyContent">
                <div class="options-grid" id="bodyGrid">
                  <!-- ÈÄâÈ°πÂ∞ÜÁî±JavaScriptÂä®ÊÄÅÁîüÊàê -->
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="bodyCustom"
                  placeholder="Ëá™ÂÆö‰πâË∫´ÊùêÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <div class="form-group">
            <div class="form-label">
              ËÇ§Ëâ≤
              <span class="icon dice-icon" onclick="randomizeField('skinColor')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('skinColor')">üñã</span>
            </div>
            <select class="form-select" id="skinColor">
              <option value="">ÈÄâÊã©ËÇ§Ëâ≤</option>
              <option value="ÂÜ∑ÁôΩ">ÂÜ∑ÁôΩ</option>
              <option value="ÊöñÁôΩ">ÊöñÁôΩ</option>
              <option value="ÂÅèÈªÑ">ÂÅèÈªÑ</option>
              <option value="Â∞èÈ∫¶Ëâ≤">Â∞èÈ∫¶Ëâ≤</option>
              <option value="ËúúÁ≥ñËâ≤">ËúúÁ≥ñËâ≤</option>
              <option value="Ê∑±Ê£ïËâ≤">Ê∑±Ê£ïËâ≤</option>
              <option value="ÈÄèÊòéÊÑüÁôΩ">ÈÄèÊòéÊÑüÁôΩ</option>
              <option value="ÁóÖÊÄÅËãçÁôΩ">ÁóÖÊÄÅËãçÁôΩ</option>
              <option value="ÈªëÁöÆ">ÈªëÁöÆ</option>
            </select>
            <input type="text" class="form-input custom-input" id="skinColorCustom" placeholder="Ëá™ÂÆö‰πâËÇ§Ëâ≤" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Áû≥Ëâ≤
              <span class="icon dice-icon" onclick="randomizeField('eyeColor')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('eyeColor')">üñã</span>
            </div>
            <select class="form-select" id="eyeColor">
              <option value="">ÈÄâÊã©Áû≥Ëâ≤</option>
              <option value="ÈªëËâ≤">ÈªëËâ≤</option>
              <option value="ÁôΩËâ≤">ÁôΩËâ≤</option>
              <option value="Ê£ïËâ≤">Ê£ïËâ≤</option>
              <option value="ÁÅ∞Ëâ≤">ÁÅ∞Ëâ≤</option>
              <option value="ÈÖíÁ∫¢Ëâ≤">ÈÖíÁ∫¢Ëâ≤</option>
              <option value="‰∫ÆÁ∫¢Ëâ≤">‰∫ÆÁ∫¢Ëâ≤</option>
              <option value="Á¥´Ëâ≤">Á¥´Ëâ≤</option>
              <option value="ËìùËâ≤">ËìùËâ≤</option>
              <option value="ÁªøËâ≤">ÁªøËâ≤</option>
              <option value="Èì∂Ëâ≤">Èì∂Ëâ≤</option>
              <option value="ÁÉüÁ¥´Ëâ≤">ÁÉüÁ¥´Ëâ≤</option>
              <option value="ÊµÖÁ¥´">ÊµÖÁ¥´</option>
              <option value="ÊµÖÁ≤âËâ≤">ÊµÖÁ≤âËâ≤</option>
              <option value="Áé´Áë∞Ëâ≤">Áé´Áë∞Ëâ≤</option>
              <option value="ÈõæËìùÁÅ∞">ÈõæËìùÁÅ∞</option>
              <option value="ÊµÖÊµ∑Ëìù">ÊµÖÊµ∑Ëìù</option>
              <option value="Â¢®ÁªøËâ≤">Â¢®ÁªøËâ≤</option>
              <option value="ÁÅ∞ÁªøËâ≤">ÁÅ∞ÁªøËâ≤</option>
              <option value="ÁÅ∞ËìùËâ≤">ÁÅ∞ËìùËâ≤</option>
              <option value="Â§©ËìùËâ≤">Â§©ËìùËâ≤</option>
            </select>
            <input type="text" class="form-input custom-input" id="eyeColorCustom" placeholder="Ëá™ÂÆö‰πâÁû≥Ëâ≤" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Èù¢ÈÉ®ÁâπÂæÅ
              <span class="icon dice-icon" onclick="randomizeField('facialFeatures')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('facialFeatures')">üñã</span>
            </div>
            <select class="form-select" id="facialFeatures">
              <option value="">ÈÄâÊã©Èù¢ÈÉ®ÁâπÂæÅ</option>
              <option value="Âá§Áúº">Âá§Áúº</option>
              <option value="ÂúÜÁúº">ÂúÜÁúº</option>
              <option value="Ê°ÉËä±Áúº">Ê°ÉËä±Áúº</option>
              <option value="ÂçïÁúºÁöÆ">ÂçïÁúºÁöÆ</option>
              <option value="ÂÜÖÂèå">ÂÜÖÂèå</option>
              <option value="ÁãóÁãó‰∏ãÂûÇÁúº">ÁãóÁãó‰∏ãÂûÇÁúº</option>
              <option value="ÈïøÁù´ÊØõ">ÈïøÁù´ÊØõ</option>
              <option value="ÂæÆÁ¨ëÂîá">ÂæÆÁ¨ëÂîá</option>
              <option value="ËñÑÂîá">ËñÑÂîá</option>
              <option value="ÂéöÂîá">ÂéöÂîá</option>
              <option value="Â∞èÁøòÈºª">Â∞èÁøòÈºª</option>
              <option value="È´òÈºªÊ¢Å">È´òÈºªÊ¢Å</option>
              <option value="Áæé‰∫∫Áó£">Áæé‰∫∫Áó£</option>
              <option value="Ê≥™Áó£">Ê≥™Áó£</option>
              <option value="ÁúâÂøÉÁó£">ÁúâÂøÉÁó£</option>
              <option value="ÈÖíÁ™ù">ÈÖíÁ™ù</option>
              <option value="Ê¢®Ê∂°">Ê¢®Ê∂°</option>
              <option value="ÈõÄÊñë">ÈõÄÊñë</option>
              <option value="Áæé‰∫∫Â∞ñ">Áæé‰∫∫Â∞ñ</option>
              <option value="Â©¥ÂÑøËÇ•">Â©¥ÂÑøËÇ•</option>
              <option value="ÁúâÊØõÊúâÁñ§">ÁúâÊØõÊúâÁñ§</option>
            </select>
            <input type="text" class="form-input custom-input" id="facialFeaturesCustom" placeholder="Ëá™ÂÆö‰πâÈù¢ÈÉ®ÁâπÂæÅ" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ÂèëËâ≤
              <span class="icon dice-icon" onclick="randomizeField('hairColor')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('hairColor')">üñã</span>
            </div>
            <select class="form-select" id="hairColor">
              <option value="">ÈÄâÊã©ÂèëËâ≤</option>
              <option value="ÈªëËâ≤">ÈªëËâ≤</option>
              <option value="ÁôΩËâ≤">ÁôΩËâ≤</option>
              <option value="Ê£ïËâ≤">Ê£ïËâ≤</option>
              <option value="Áé´Áë∞Èáë">Áé´Áë∞Èáë</option>
              <option value="ÈÖíÁ∫¢Ëâ≤">ÈÖíÁ∫¢Ëâ≤</option>
              <option value="‰∫ÆÁ∫¢Ëâ≤">‰∫ÆÁ∫¢Ëâ≤</option>
              <option value="Á¥´Ëâ≤">Á¥´Ëâ≤</option>
              <option value="ËìùËâ≤">ËìùËâ≤</option>
              <option value="ÁªøËâ≤">ÁªøËâ≤</option>
              <option value="Â•∂Â•∂ÁÅ∞">Â•∂Â•∂ÁÅ∞</option>
              <option value="Èì∂Ëâ≤">Èì∂Ëâ≤</option>
              <option value="Ê∑±ÁÅ∞Ëâ≤">Ê∑±ÁÅ∞Ëâ≤</option>
              <option value="ÁÉüÁÅ∞Ëâ≤">ÁÉüÁÅ∞Ëâ≤</option>
              <option value="ÊµÖÁ¥´">ÊµÖÁ¥´</option>
              <option value="ÊµÖÁ≤âËâ≤">ÊµÖÁ≤âËâ≤</option>
              <option value="Áé´Áë∞Ëâ≤">Áé´Áë∞Ëâ≤</option>
              <option value="ÈõæËìùÁÅ∞">ÈõæËìùÁÅ∞</option>
              <option value="ÊµÖÊµ∑Ëìù">ÊµÖÊµ∑Ëìù</option>
              <option value="Ê∏êÂèòËâ≤">Ê∏êÂèòËâ≤</option>
              <option value="ÊåëÊüì">ÊåëÊüì</option>
              <option value="ÊåÇËÄ≥Êüì">ÊåÇËÄ≥Êüì</option>
              <option value="ÂèëÂ∞æÊüì">ÂèëÂ∞æÊüì</option>
            </select>
            <input type="text" class="form-input custom-input" id="hairColorCustom" placeholder="Ëá™ÂÆö‰πâÂèëËâ≤" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ÂèëÂûã
              <span class="icon dice-icon" onclick="randomizeField('hairStyle')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('hairStyle')">üñã</span>
            </div>
            <select class="form-select" id="hairStyle">
              <option value="">ÈÄâÊã©ÂèëÂûã</option>
              <option value="Áü≠Âèë">Áü≠Âèë</option>
              <option value="‰∏≠ÈïøÂèë">‰∏≠ÈïøÂèë</option>
              <option value="ÈïøÂèë">ÈïøÂèë</option>
              <option value="ÂèäËÇ©ÈïøÂèë">ÂèäËÇ©ÈïøÂèë</option>
              <option value="ÂèäËÖ∞ÈïøÂèë">ÂèäËÖ∞ÈïøÂèë</option>
              <option value="Áõ¥Âèë">Áõ¥Âèë</option>
              <option value="Âç∑Âèë">Âç∑Âèë</option>
              <option value="ÊùøÂØ∏">ÊùøÂØ∏</option>
              <option value="ÂâçÂà∫">ÂâçÂà∫</option>
              <option value="ÂæÆÂàÜÁ¢éÁõñ">ÂæÆÂàÜÁ¢éÁõñ</option>
              <option value="ËÉåÂ§¥">ËÉåÂ§¥</option>
              <option value="‰∏≠ÂàÜ">‰∏≠ÂàÜ</option>
              <option value="ÁãºÂ∞æÂèëÂûã">ÁãºÂ∞æÂèëÂûã</option>
              <option value="ÂçäÊâéÂèë">ÂçäÊâéÂèë</option>
              <option value="È´òÈ©¨Â∞æ">È´òÈ©¨Â∞æ</option>
              <option value="‰ΩéÈ©¨Â∞æ">‰ΩéÈ©¨Â∞æ</option>
              <option value="‰∏∏Â≠êÂ§¥">‰∏∏Â≠êÂ§¥</option>
              <option value="ÈïøÁõ¥Âèë">ÈïøÁõ¥Âèë</option>
              <option value="Â§ßÊ≥¢Êµ™ÈïøÂèë">Â§ßÊ≥¢Êµ™ÈïøÂèë</option>
              <option value="ÂèåÈ©¨Â∞æ">ÂèåÈ©¨Â∞æ</option>
              <option value="Âçï‰æßÁºñÂèë">Âçï‰æßÁºñÂèë</option>
            </select>
            <input type="text" class="form-input custom-input" id="hairStyleCustom" placeholder="Ëá™ÂÆö‰πâÂèëÂûã" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Êó•Â∏∏Á©øÊê≠ÂÅèÂ•Ω
              <span class="icon dice-icon" onclick="randomizeField('dressStyle')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('dressStyle')">üñã</span>
            </div>
            <select class="form-select" id="dressStyle">
              <option value="">ÈÄâÊã©Á©øÊê≠È£éÊ†º</option>
              <option value="Ê∏©ÊüîÊ∑ëÂ•≥È£é">Ê∏©ÊüîÊ∑ëÂ•≥È£é</option>
              <option value="Ê¥ªÊ≥ºÂèØÁà±È£é">Ê¥ªÊ≥ºÂèØÁà±È£é</option>
              <option value="Ê≥ïÂºè‰ºòÈõÖ">Ê≥ïÂºè‰ºòÈõÖ</option>
              <option value="Èü©Á≥ªÊΩÆÊµÅÈ£é">Èü©Á≥ªÊΩÆÊµÅÈ£é</option>
              <option value="Èü©Á≥ªÂ•≥Âõ¢È£é">Èü©Á≥ªÂ•≥Âõ¢È£é</option>
              <option value="Ê¨ßÁæéÁÅ´Ëæ£È£é">Ê¨ßÁæéÁÅ´Ëæ£È£é</option>
              <option value="ËÅåÂú∫ÈÄöÂã§È£é">ËÅåÂú∫ÈÄöÂã§È£é</option>
              <option value="Áü•ËØÜÂàÜÂ≠êÈ£é">Áü•ËØÜÂàÜÂ≠êÈ£é</option>
              <option value="ÈÇªÂÆ∂ÁÆÄÁ∫¶È£é">ÈÇªÂÆ∂ÁÆÄÁ∫¶È£é</option>
              <option value="Ê£ÆÁ≥ªÊñáËâ∫">Ê£ÆÁ≥ªÊñáËâ∫</option>
              <option value="ÁÆÄÁ∫¶ÁõêÁ≥ª">ÁÆÄÁ∫¶ÁõêÁ≥ª</option>
              <option value="ÊÖµÊáíÈöèÊÄß">ÊÖµÊáíÈöèÊÄß</option>
              <option value="Á∫ØÊ¨≤È£é">Á∫ØÊ¨≤È£é</option>
              <option value="Y2KÂ§çÂè§È£é">Y2KÂ§çÂè§È£é</option>
              <option value="Êñ∞‰∏≠ÂºèÈ£éÊ†º">Êñ∞‰∏≠ÂºèÈ£éÊ†º</option>
              <option value="‰∫öÊñáÂåñËæ£Â¶πÈ£é">‰∫öÊñáÂåñËæ£Â¶πÈ£é</option>
              <option value="Ê¥õ‰∏ΩÂ°î">Ê¥õ‰∏ΩÂ°î</option>
              <option value="È´òÂÆöÁ§ºÊúç">È´òÂÆöÁ§ºÊúç</option>
              <option value="ÂÅ•Ë∫´ÊàøËøêÂä®È£é">ÂÅ•Ë∫´ÊàøËøêÂä®È£é</option>
              <option value="Êà∑Â§ñÊú∫ËÉΩÈ£é">Êà∑Â§ñÊú∫ËÉΩÈ£é</option>
              <option value="ÂêçÂ™õÈ£é">ÂêçÂ™õÈ£é</option>
              <option value="ÊÄßÊÑüÂæ°ÂßêÈ£é">ÊÄßÊÑüÂæ°ÂßêÈ£é</option>
              <option value="Èü©Á≥ªÁî∑Âõ¢È£é">Èü©Á≥ªÁî∑Âõ¢È£é</option>
              <option value="È´òÂÆöË•øË£Ö">È´òÂÆöË•øË£Ö</option>
              <option value="ÂïÜÂä°‰ºëÈó≤">ÂïÜÂä°‰ºëÈó≤</option>
              <option value="ÁæéÂºè‰ºëÈó≤">ÁæéÂºè‰ºëÈó≤</option>
              <option value="Êó•Á≥ª‰ºëÈó≤">Êó•Á≥ª‰ºëÈó≤</option>
              <option value="ÁÆÄÁ∫¶Âü∫Á°ÄÊ¨æ">ÁÆÄÁ∫¶Âü∫Á°ÄÊ¨æ</option>
              <option value="Ë°óÂ§¥ÊΩÆÊµÅ">Ë°óÂ§¥ÊΩÆÊµÅ</option>
              <option value="È´òË°óÈ£éÊ†º">È´òË°óÈ£éÊ†º</option>
              <option value="ÂòªÂìàËØ¥Âî±">ÂòªÂìàËØ¥Âî±</option>
              <option value="Â∑•Ë£ÖÈ£éÊ†º">Â∑•Ë£ÖÈ£éÊ†º</option>
              <option value="Êà∑Â§ñËøêÂä®È£é">Êà∑Â§ñËøêÂä®È£é</option>
              <option value="ÈõÖÁóûÁªÖÂ£´È£é">ÈõÖÁóûÁªÖÂ£´È£é</option>
              <option value="‰π¶Âç∑Ê∞îÈ£éÊ†º">‰π¶Âç∑Ê∞îÈ£éÊ†º</option>
              <option value="ËÄÅÈí±È£é">ËÄÅÈí±È£é</option>
              <option value="Â§çÂè§Ê∏ØÈ£é">Â§çÂè§Ê∏ØÈ£é</option>
              <option value="Á≤æËá¥Â≠¶Èô¢È£é">Á≤æËá¥Â≠¶Èô¢È£é</option>
              <option value="Â±ÖÂÆ∂ËàíÈÄÇÈ£é">Â±ÖÂÆ∂ËàíÈÄÇÈ£é</option>
              <option value="Ë°¨Ë°£">Ë°¨Ë°£</option>
              <option value="ÊØõË°£">ÊØõË°£</option>
              <option value="ÂêäÂ∏¶Ë£ô">ÂêäÂ∏¶Ë£ô</option>
              <option value="ËÉåÂøÉÁÉ≠Ë£§">ËÉåÂøÉÁÉ≠Ë£§</option>
              <option value="È£éË°£">È£éË°£</option>
            </select>
            <input type="text" class="form-input custom-input" id="dressStyleCustom" placeholder="Ëá™ÂÆö‰πâÁ©øÊê≠È£éÊ†º" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Ê†áÂøóÊÄßÈÖçÈ•∞
              <span class="icon dice-icon" onclick="randomizeField('accessories')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('accessories')">üñã</span>
            </div>
            <select class="form-select" id="accessories">
              <option value="">ÈÄâÊã©ÈÖçÈ•∞</option>
              <option value="Ê°ÜÊû∂ÁúºÈïú">Ê°ÜÊû∂ÁúºÈïú</option>
              <option value="ÈáëÂ±ûÁªÜÊ°ÜÁúºÈïú">ÈáëÂ±ûÁªÜÊ°ÜÁúºÈïú</option>
              <option value="ËÄ≥ÁéØ">ËÄ≥ÁéØ</option>
              <option value="ÈïøËÄ≥Âù†">ÈïøËÄ≥Âù†</option>
              <option value="ËÄ≥Èíâ">ËÄ≥Èíâ</option>
              <option value="È°πÈìæ">È°πÈìæ</option>
              <option value="ÈáëÂ±ûÈìæÊù°">ÈáëÂ±ûÈìæÊù°</option>
              <option value="ÊâãË°®">ÊâãË°®</option>
              <option value="ÊàíÊåá">ÊàíÊåá</option>
              <option value="Èì∂ÊàíÊåá">Èì∂ÊàíÊåá</option>
              <option value="ÊâãÈìæ">ÊâãÈìæ</option>
              <option value="ÊâãÈïØ">ÊâãÈïØ</option>
              <option value="ÂîáÈíâ">ÂîáÈíâ</option>
              <option value="ÁúâÈíâ">ÁúâÈíâ</option>
              <option value="‰π≥Èíâ">‰π≥Èíâ</option>
              <option value="ËàåÈíâ">ËàåÈíâ</option>
              <option value="È¢ÜÂ∏¶">È¢ÜÂ∏¶</option>
              <option value="ËÉ∏Èíà">ËÉ∏Èíà</option>
              <option value="Ë¢ñÊâ£">Ë¢ñÊâ£</option>
              <option value="Ê£íÁêÉÂ∏Ω">Ê£íÁêÉÂ∏Ω</option>
              <option value="Ê∏îÂ§´Â∏Ω">Ê∏îÂ§´Â∏Ω</option>
              <option value="Âè£ÁΩ©">Âè£ÁΩ©</option>
            </select>
            <input type="text" class="form-input custom-input" id="accessoriesCustom" placeholder="Ëá™ÂÆö‰πâÈÖçÈ•∞" />
          </div>
        </div>

        <!-- ÂÖ∂‰ªñËÆæÂÆö -->
        <div class="form-section">
          <div class="form-group full-width">
            <div class="form-label">
              <span class="crown-icon"></span>
              ÂÖ∂‰ªñËÆæÂÆö
            </div>
          </div>

          <div class="form-group">
            <div class="form-label">
              ÁóÖÁóá
              <span class="icon dice-icon" onclick="randomizeField('illness')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('illness')">üñã</span>
            </div>
            <select class="form-select" id="illness">
              <option value="">ÈÄâÊã©ÁóÖÁóá</option>
              <option value="ËÉÉÁóÖ">ËÉÉÁóÖ</option>
              <option value="ÂÅèÂ§¥Áóõ">ÂÅèÂ§¥Áóõ</option>
              <option value="Â§±Áú†Áóá">Â§±Áú†Áóá</option>
              <option value="ÊäëÈÉÅÁóá">ÊäëÈÉÅÁóá</option>
              <option value="ÁÑ¶ËôëÁóá">ÁÑ¶ËôëÁóá</option>
              <option value="Ë∫ÅÈÉÅÁóá">Ë∫ÅÈÉÅÁóá</option>
              <option value="PTSD">PTSD</option>
              <option value="ÊñØÂæ∑Âì•Â∞îÊë©ÁªºÂêàÂæÅ">ÊñØÂæ∑Âì•Â∞îÊë©ÁªºÂêàÂæÅ</option>
              <option value="ADHD">ADHD</option>
              <option value="Á§æ‰∫§ÊÅêÊÉßÁóá">Á§æ‰∫§ÊÅêÊÉßÁóá</option>
              <option value="ÂπΩÈó≠ÊÅêÊÉßÁóá">ÂπΩÈó≠ÊÅêÊÉßÁóá</option>
              <option value="ÂìÆÂñò">ÂìÆÂñò</option>
              <option value="ÂøÉËÑèÁóÖ">ÂøÉËÑèÁóÖ</option>
              <option value="ËøáÊïè‰ΩìË¥®">ËøáÊïè‰ΩìË¥®</option>
              <option value="ÂéåÈ£üÁóá">ÂéåÈ£üÁóá</option>
              <option value="Êö¥È£üÁóá">Êö¥È£üÁóá</option>
              <option value="Âº∫Ëø´Áóá">Âº∫Ëø´Áóá</option>
              <option value="Ê¥ÅÁôñ">Ê¥ÅÁôñ</option>
              <option value="ÊÅêÈ´ò">ÊÅêÈ´ò</option>
              <option value="ËÑ∏Áõ≤">ËÑ∏Áõ≤</option>
              <option value="ÈÄâÊã©Âõ∞ÈöæÁóá">ÈÄâÊã©Âõ∞ÈöæÁóá</option>
              <option value="‰∫∫Ê†ºÂàÜË£Ç">‰∫∫Ê†ºÂàÜË£Ç</option>
              <option value="ÊÉÖÊÑüÈöîÁ¶ª">ÊÉÖÊÑüÈöîÁ¶ª</option>
              <option value="ÈáçÂ∫¶ËßÜÂäõÈöúÁ¢ç">ÈáçÂ∫¶ËßÜÂäõÈöúÁ¢ç</option>
              <option value="ÁúºÁõ≤">ÁúºÁõ≤</option>
              <option value="ËÄ≥ËÅã">ËÄ≥ËÅã</option>
              <option value="ÂìëÂ∑¥">ÂìëÂ∑¥</option>
              <option value="‰∏ãËÇ¢Áò´Áó™">‰∏ãËÇ¢Áò´Áó™</option>
              <option value="ÂãÉËµ∑ÈöúÁ¢ç">ÂãÉËµ∑ÈöúÁ¢ç</option>
              <option value="Êó†Ê≥ïÂ∞ÑÁ≤æ">Êó†Ê≥ïÂ∞ÑÁ≤æ</option>
              <option value="ÊÄßÁòæ">ÊÄßÁòæ</option>
            </select>
            <input type="text" class="form-input custom-input" id="illnessCustom" placeholder="Ëá™ÂÆö‰πâÁóÖÁóá" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ‰∫∫Áâ©ÁâπÁÇπ
              <span class="icon dice-icon" onclick="randomizeField('characterTrait')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('characterTrait')">üñã</span>
            </div>
            <select class="form-select" id="characterTrait">
              <option value="">ÈÄâÊã©ÁâπÁÇπ</option>
              <option value="Êé®ÁúºÈïú">Êé®ÁúºÈïú</option>
              <option value="ÊÄùËÄÉÊó∂‰ºöËΩªÂí¨‰∏ãÂîá">ÊÄùËÄÉÊó∂‰ºöËΩªÂí¨‰∏ãÂîá</option>
              <option value="‰∏é‰∫∫‰∫§Ë∞àÊó∂Ë∫´‰Ωì‰ºöÂæÆÂæÆÂâçÂÄæ">‰∏é‰∫∫‰∫§Ë∞àÊó∂Ë∫´‰Ωì‰ºöÂæÆÂæÆÂâçÂÄæ</option>
              <option value="ÊääÁé©Áâ©ÂìÅ">ÊääÁé©Áâ©ÂìÅ</option>
              <option value="ÊåâÂ§™Èò≥Á©¥">ÊåâÂ§™Èò≥Á©¥</option>
              <option value="ÊâãÊèíÂÖú">ÊâãÊèíÂÖú</option>
              <option value="Âè£Â§¥Á¶Ö">Âè£Â§¥Á¶Ö</option>
              <option value="Êää'Ë∞¢Ë∞¢'ÊåÇÂú®Âò¥Ëæπ">Êää"Ë∞¢Ë∞¢"ÊåÇÂú®Âò¥Ëæπ</option>
              <option value="ÂñúÊ¨¢ËØ¥Âè†ËØç">ÂñúÊ¨¢ËØ¥Âè†ËØç</option>
              <option value="Ê∏ØÂè∞ËÖî">Ê∏ØÂè∞ËÖî</option>
              <option value="Âåó‰∫¨ËÖî">Âåó‰∫¨ËÖî</option>
              <option value="‰∏úÂåóËØù">‰∏úÂåóËØù</option>
              <option value="Á≤§ËØ≠">Á≤§ËØ≠</option>
              <option value="ËØ¥ËØùÊó∂ÂñúÊ¨¢ÈÖç‰∏äËÇ¢‰ΩìÊé•Ëß¶">ËØ¥ËØùÊó∂ÂñúÊ¨¢ÈÖç‰∏äËÇ¢‰ΩìÊé•Ëß¶</option>
            </select>
            <input type="text" class="form-input custom-input" id="characterTraitCustom" placeholder="Ëá™ÂÆö‰πâÁâπÁÇπ" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ‰ΩìÂë≥
              <span class="icon dice-icon" onclick="randomizeField('bodyScent')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('bodyScent')">üñã</span>
            </div>
            <select class="form-select" id="bodyScent">
              <option value="">ÈÄâÊã©‰ΩìÂë≥</option>
              <option value="Êó†ÁâπÊÆäÊ∞îÂë≥">Êó†ÁâπÊÆäÊ∞îÂë≥</option>
              <option value="Ê∏ÖÊ∑°ÁöÑÁöÇÈ¶ô">Ê∏ÖÊ∑°ÁöÑÁöÇÈ¶ô</option>
              <option value="Ê∏ÖÁàΩÁöÑÊ¥óË°£Ê∂≤Âë≥">Ê∏ÖÁàΩÁöÑÊ¥óË°£Ê∂≤Âë≥</option>
              <option value="Èò≥ÂÖâÊôíËøáÁöÑÂë≥ÈÅì">Èò≥ÂÖâÊôíËøáÁöÑÂë≥ÈÅì</option>
              <option value="ÁâõÂ•∂Âë≥">ÁâõÂ•∂Âë≥</option>
              <option value="Â•∂Á≥ñÂë≥">Â•∂Á≥ñÂë≥</option>
              <option value="Ê∑°Ê∑°ÁöÑËä±È¶ôÂë≥">Ê∑°Ê∑°ÁöÑËä±È¶ôÂë≥</option>
              <option value="Èõ®ÂêéÊ£ÆÊûóÁöÑÊ∞îÊÅØ">Èõ®ÂêéÊ£ÆÊûóÁöÑÊ∞îÊÅØ</option>
              <option value="Â∏∏Áî®ÁöÑÈ¶ôÊ∞¥Âë≥">Â∏∏Áî®ÁöÑÈ¶ôÊ∞¥Âë≥</option>
              <option value="Êú®Ë¥®È¶ô">Êú®Ë¥®È¶ô</option>
              <option value="Êµ∑Ê¥ãË∞ÉÈ¶ô">Êµ∑Ê¥ãË∞ÉÈ¶ô</option>
              <option value="ÊüëÊ©òÈ¶ô">ÊüëÊ©òÈ¶ô</option>
              <option value="Ëç∑Â∞îËíôÊ∞îÊÅØÂº∫ÁÉà">Ëç∑Â∞îËíôÊ∞îÊÅØÂº∫ÁÉà</option>
              <option value="Ê±óÂë≥">Ê±óÂë≥</option>
              <option value="ÁÉüËçâÂë≥">ÁÉüËçâÂë≥</option>
              <option value="ÂíñÂï°È¶ô">ÂíñÂï°È¶ô</option>
              <option value="Ëå∂È¶ô">Ëå∂È¶ô</option>
              <option value="Ê∂àÊØíÊ∞¥Âë≥">Ê∂àÊØíÊ∞¥Âë≥</option>
              <option value="‰π¶Â¢®Âë≥">‰π¶Â¢®Âë≥</option>
              <option value="ÂÜ∑ÂÜΩÁöÑÁ©∫Ê∞îÂë≥">ÂÜ∑ÂÜΩÁöÑÁ©∫Ê∞îÂë≥</option>
              <option value="ÁîúËÖªÁöÑÁ≥ïÁÇπÂë≥">ÁîúËÖªÁöÑÁ≥ïÁÇπÂë≥</option>
              <option value="ÂæÆÂº±ÁöÑË°ÄËÖ•Âë≥">ÂæÆÂº±ÁöÑË°ÄËÖ•Âë≥</option>
            </select>
            <input type="text" class="form-input custom-input" id="bodyScentCustom" placeholder="Ëá™ÂÆö‰πâ‰ΩìÂë≥" />
          </div>

          <div class="form-group">
            <div class="form-label">
              Ë∫´‰ΩìÊïèÊÑüÂ∫¶
              <span class="icon dice-icon" onclick="randomizeField('sensitivity')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('sensitivity')">üñã</span>
            </div>
            <select class="form-select" id="sensitivity">
              <option value="">ÈÄâÊã©ÊïèÊÑüÂ∫¶</option>
              <option value="Ë∫´‰ΩìËøüÈíù">Ë∫´‰ΩìËøüÈíù</option>
              <option value="ÊôÆÈÄöÊïèÊÑü">ÊôÆÈÄöÊïèÊÑü</option>
              <option value="ËæÉ‰∏∫ÊïèÊÑü">ËæÉ‰∏∫ÊïèÊÑü</option>
              <option value="ÂæàÊïèÊÑü">ÂæàÊïèÊÑü</option>
              <option value="ÂÖ®Ë∫´ÈÉΩÊòØÊïèÊÑüÁÇπ">ÂÖ®Ë∫´ÈÉΩÊòØÊïèÊÑüÁÇπ</option>
              <option value="ËΩªËß¶Âç≥ÂèØÂî§Ëµ∑Âø´ÊÑü">ËΩªËß¶Âç≥ÂèØÂî§Ëµ∑Âø´ÊÑü</option>
              <option value="ÁóõÊÑü‰∏éÂø´ÊÑüÁïåÈôêÊ®°Á≥ä">ÁóõÊÑü‰∏éÂø´ÊÑüÁïåÈôêÊ®°Á≥ä</option>
              <option value="Ëß¶Á¢∞Â∞±È´òÊΩÆ">Ëß¶Á¢∞Â∞±È´òÊΩÆ</option>
              <option value="Â§öÈáçÈ´òÊΩÆ‰ΩìË¥®">Â§öÈáçÈ´òÊΩÆ‰ΩìË¥®</option>
              <option value="ÊÑüËßâËøáËΩΩ(ÊòìË¢´ËøáÂ∫¶Âà∫ÊøÄ)">ÊÑüËßâËøáËΩΩ(ÊòìË¢´ËøáÂ∫¶Âà∫ÊøÄ)</option>
            </select>
            <input type="text" class="form-input custom-input" id="sensitivityCustom" placeholder="Ëá™ÂÆö‰πâÊïèÊÑüÂ∫¶" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ËøáÂæÄÊÄßÁªèÂéÜ
              <span class="icon dice-icon" onclick="randomizeField('sexualHistory')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('sexualHistory')">üñã</span>
            </div>
            <select class="form-select" id="sexualHistory">
              <option value="">ÈÄâÊã©ÊÄßÁªèÂéÜ</option>
              <option value="Êó†ÊÄßÁªèÈ™å">Êó†ÊÄßÁªèÈ™å</option>
              <option value="‰ªÖÊúâÁêÜËÆ∫Áü•ËØÜ">‰ªÖÊúâÁêÜËÆ∫Áü•ËØÜ</option>
              <option value="‰ªÖÊúâ‰∏ÄÊ¨°ÁªèÈ™å">‰ªÖÊúâ‰∏ÄÊ¨°ÁªèÈ™å</option>
              <option value="ÁªèÈ™åÂæàÂ∞ë">ÁªèÈ™åÂæàÂ∞ë</option>
              <option value="Âè™ÊúâÂõ∫ÂÆöÁöÑÈïøÊúü‰º¥‰æ£">Âè™ÊúâÂõ∫ÂÆöÁöÑÈïøÊúü‰º¥‰æ£</option>
              <option value="ÁªèÈ™åÈÄÇ‰∏≠">ÁªèÈ™åÈÄÇ‰∏≠</option>
              <option value="ÊúâËøáÊï∞‰Ωç‰º¥‰æ£">ÊúâËøáÊï∞‰Ωç‰º¥‰æ£</option>
              <option value="ÁªèÈ™å‰∏∞ÂØå">ÁªèÈ™å‰∏∞ÂØå</option>
              <option value="ÊÄßËßÇÂøµÂºÄÊîæ">ÊÄßËßÇÂøµÂºÄÊîæ</option>
              <option value="ÊÄßÂÖ≥Á≥ªÊ∑∑‰π±">ÊÄßÂÖ≥Á≥ªÊ∑∑‰π±</option>
              <option value="ÊúâBDSMÁªèÈ™å">ÊúâBDSMÁªèÈ™å</option>
              <option value="‰ªÖÊúâÂêåÊÄßÁªèÈ™å">‰ªÖÊúâÂêåÊÄßÁªèÈ™å</option>
              <option value="‰ªÖÊúâÂºÇÊÄßÁªèÈ™å">‰ªÖÊúâÂºÇÊÄßÁªèÈ™å</option>
              <option value="ÂèåÊÄßÁªèÈ™åÁöÜÊúâ">ÂèåÊÄßÁªèÈ™åÁöÜÊúâ</option>
              <option value="ÊúâËøáÈùûËá™ÊÑøÊÄßË°å‰∏∫">ÊúâËøáÈùûËá™ÊÑøÊÄßË°å‰∏∫</option>
              <option value="ÊõæÂ´ñÂ®º">ÊõæÂ´ñÂ®º</option>
              <option value="ÂΩìËøáÂ®º">ÂΩìËøáÂ®º</option>
              <option value="Êúâ‰∏∫‰∫ÜËµÑÊ∫êÊàñÁõÆÁöÑÁöÑÊÄßÁªèÂéÜ">Êúâ‰∏∫‰∫ÜËµÑÊ∫êÊàñÁõÆÁöÑÁöÑÊÄßÁªèÂéÜ</option>
              <option value="ÊõæÊúâÁªèÈ™å‰ΩÜÂæà‰πÖÊ≤°ÊúâÊÄßÁîüÊ¥ª">ÊõæÊúâÁªèÈ™å‰ΩÜÂæà‰πÖÊ≤°ÊúâÊÄßÁîüÊ¥ª</option>
            </select>
            <input type="text" class="form-input custom-input" id="sexualHistoryCustom" placeholder="Ëá™ÂÆö‰πâÊÄßÁªèÂéÜ" />
          </div>

          <div class="form-group">
            <div class="form-label">
              ÊÄßÊ¨≤ÊåáÊï∞
              <span class="icon dice-icon" onclick="randomizeField('libido')">‚öÖ</span>
              <span class="icon edit-icon" onclick="editCustom('libido')">üñã</span>
            </div>
            <select class="form-select" id="libido">
              <option value="">ÈÄâÊã©ÊÄßÊ¨≤ÊåáÊï∞</option>
              <option value="Á¶ÅÊ¨≤">Á¶ÅÊ¨≤</option>
              <option value="Êó†ÊÄßÊ¨≤">Êó†ÊÄßÊ¨≤</option>
              <option value="ÊûÅ‰ΩéÊÄßÊ¨≤">ÊûÅ‰ΩéÊÄßÊ¨≤</option>
              <option value="‰Ωé‰∫éÊôÆÈÄö">‰Ωé‰∫éÊôÆÈÄö</option>
              <option value="ÊôÆÈÄöÊÄßÊ¨≤">ÊôÆÈÄöÊÄßÊ¨≤</option>
              <option value="È´ò‰∫éÂπ≥Âùá">È´ò‰∫éÂπ≥Âùá</option>
              <option value="Âº∫ÁÉàÊÄßÊ¨≤">Âº∫ÁÉàÊÄßÊ¨≤</option>
              <option value="ÊûÅÈ´òÊÄßÊ¨≤">ÊûÅÈ´òÊÄßÊ¨≤</option>
              <option value="Êó∂Êó∂ÂàªÂàªÈÉΩÊúâÊûÅÈ´òÊÄßÊ¨≤">Êó∂Êó∂ÂàªÂàªÈÉΩÊúâÊûÅÈ´òÊÄßÊ¨≤</option>
            </select>
            <input type="text" class="form-input custom-input" id="libidoCustom" placeholder="Ëá™ÂÆö‰πâÊÄßÊ¨≤ÊåáÊï∞" />
          </div>

          <!-- ÊÄßÁôñ -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="kinksSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('kinks')">
                <div>
                  <span>ÊÄßÁôñ</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('kinks')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('kinks')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="kinksSelected"></div>
              <div class="collapsible-content collapsed" id="kinksContent">
                <div class="options-grid" id="kinksGrid">
                  <div class="option-btn" data-value="ÊîØÈÖç‰ªñ‰∫∫">ÊîØÈÖç‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="ÊçÜÁªë‰ªñ‰∫∫">ÊçÜÁªë‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="ÊéåÊé¥ÊàñÈû≠Êâì‰ªñ‰∫∫">ÊéåÊé¥ÊàñÈû≠Êâì‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="Ë®ÄËØ≠ÁæûËæ±‰ªñ‰∫∫">Ë®ÄËØ≠ÁæûËæ±‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="Á≤æÁ•ûÊéßÂà∂">Á≤æÁ•ûÊéßÂà∂</div>
                  <div class="option-btn" data-value="ÂëΩ‰ª§‰∏éÊúç‰ªé">ÂëΩ‰ª§‰∏éÊúç‰ªé</div>
                  <div class="option-btn" data-value="ËÆæËÆ°Âπ∂ÊéßÂà∂ÊÉÖËäÇ">ËÆæËÆ°Âπ∂ÊéßÂà∂ÊÉÖËäÇ</div>
                  <div class="option-btn" data-value="Â∞Ü‰º¥‰æ£ÂΩì‰ΩúÂÆ†Áâ©È•≤ÂÖª">Â∞Ü‰º¥‰æ£ÂΩì‰ΩúÂÆ†Áâ©È•≤ÂÖª</div>
                  <div class="option-btn" data-value="ËÆ©‰º¥‰æ£Â´âÂ¶í">ËÆ©‰º¥‰æ£Â´âÂ¶í</div>
                  <div class="option-btn" data-value="ÈÄöËøá‰ªªÂä°ÊàñËÄÉÈ™åÊéßÂà∂‰º¥‰æ£">ÈÄöËøá‰ªªÂä°ÊàñËÄÉÈ™åÊéßÂà∂‰º¥‰æ£</div>
                  <div class="option-btn" data-value="ÂØπ‰º¥‰æ£ËøõË°åË∫´‰ΩìÂ¥áÊãú">ÂØπ‰º¥‰æ£ËøõË°åË∫´‰ΩìÂ¥áÊãú</div>
                  <div class="option-btn" data-value="Â§∫Âèñ‰º¥‰æ£ÁöÑÊÑüÂÆò(Â¶ÇËíôÁúº)">Â§∫Âèñ‰º¥‰æ£ÁöÑÊÑüÂÆò(Â¶ÇËíôÁúº)</div>
                  <div class="option-btn" data-value="Âà∂ÈÄ†Âπ∂Ê¨£Ëµè‰º¥‰æ£ÁöÑÁóõËã¶ÊàñÂø´‰πêË°®ÊÉÖ">
                    Âà∂ÈÄ†Âπ∂Ê¨£Ëµè‰º¥‰æ£ÁöÑÁóõËã¶ÊàñÂø´‰πêË°®ÊÉÖ
                  </div>
                  <div class="option-btn" data-value="ÂØπ‰º¥‰æ£ËøõË°åÂº∫Âà∂È´òÊΩÆ">ÂØπ‰º¥‰æ£ËøõË°åÂº∫Âà∂È´òÊΩÆ</div>
                  <div class="option-btn" data-value="ÂÜ≥ÂÆö‰º¥‰æ£ÁöÑË°£ÁùÄ">ÂÜ≥ÂÆö‰º¥‰æ£ÁöÑË°£ÁùÄ</div>
                  <div class="option-btn" data-value="Âú®‰º¥‰æ£Ë∫´‰∏äÁïô‰∏ãÂç∞ËÆ∞(Â¶ÇÂêªÁóï)">Âú®‰º¥‰æ£Ë∫´‰∏äÁïô‰∏ãÂç∞ËÆ∞(Â¶ÇÂêªÁóï)</div>
                  <div class="option-btn" data-value="ÂÆ°ÈóÆÂºèÂØπËØù">ÂÆ°ÈóÆÂºèÂØπËØù</div>
                  <div class="option-btn" data-value="ÂâÉÊØõ">ÂâÉÊØõ</div>
                  <div class="option-btn" data-value="ÁÅåËÇ†">ÁÅåËÇ†</div>
                  <div class="option-btn" data-value="Á¶ÅÊ≠¢È´òÊΩÆ">Á¶ÅÊ≠¢È´òÊΩÆ</div>
                  <div class="option-btn" data-value="Ëá£Êúç‰∫é‰∫∫">Ëá£Êúç‰∫é‰∫∫</div>
                  <div class="option-btn" data-value="Ë¢´ÊçÜÁªë">Ë¢´ÊçÜÁªë</div>
                  <div class="option-btn" data-value="Ë¢´ÊéåÊé¥ÊàñË¢´Èû≠Êâì">Ë¢´ÊéåÊé¥ÊàñË¢´Èû≠Êâì</div>
                  <div class="option-btn" data-value="Ë¢´Ë®ÄËØ≠ÁæûËæ±">Ë¢´Ë®ÄËØ≠ÁæûËæ±</div>
                  <div class="option-btn" data-value="Ë¢´Á≤æÁ•ûÊéßÂà∂">Ë¢´Á≤æÁ•ûÊéßÂà∂</div>
                  <div class="option-btn" data-value="Âê¨‰ªéÂëΩ‰ª§‰∏éÂÆâÊéí">Âê¨‰ªéÂëΩ‰ª§‰∏éÂÆâÊéí</div>
                  <div class="option-btn" data-value="Êúç‰ªéÊÉÖËäÇÂÆâÊéí">Êúç‰ªéÊÉÖËäÇÂÆâÊéí</div>
                  <div class="option-btn" data-value="‰Ωú‰∏∫ÂÆ†Áâ©Ë¢´È•≤ÂÖª">‰Ωú‰∏∫ÂÆ†Áâ©Ë¢´È•≤ÂÖª</div>
                  <div class="option-btn" data-value="‰∏∫‰º¥‰æ£ËÄåÂ´âÂ¶í">‰∏∫‰º¥‰æ£ËÄåÂ´âÂ¶í</div>
                  <div class="option-btn" data-value="ÈÄöËøáÂÆåÊàê‰ªªÂä°Ëé∑ÂæóÂ•ñËµè">ÈÄöËøáÂÆåÊàê‰ªªÂä°Ëé∑ÂæóÂ•ñËµè</div>
                  <div class="option-btn" data-value="Ë∫´‰ΩìË¢´Â¥áÊãú">Ë∫´‰ΩìË¢´Â¥áÊãú</div>
                  <div class="option-btn" data-value="Ë¢´Ââ•Â§∫ÊÑüÂÆò(Â¶ÇË¢´ËíôÁúº)">Ë¢´Ââ•Â§∫ÊÑüÂÆò(Â¶ÇË¢´ËíôÁúº)</div>
                  <div class="option-btn" data-value="Ëá™Â∑±ÁöÑÁóõËã¶ÊàñÂø´‰πêË°®ÊÉÖË¢´Ê¨£Ëµè">Ëá™Â∑±ÁöÑÁóõËã¶ÊàñÂø´‰πêË°®ÊÉÖË¢´Ê¨£Ëµè</div>
                  <div class="option-btn" data-value="Ë¢´Âº∫Âà∂È´òÊΩÆ">Ë¢´Âº∫Âà∂È´òÊΩÆ</div>
                  <div class="option-btn" data-value="Ë¢´ÂÜ≥ÂÆöË°£ÁùÄ">Ë¢´ÂÜ≥ÂÆöË°£ÁùÄ</div>
                  <div class="option-btn" data-value="Ë∫´‰∏äË¢´Áïô‰∏ãÂç∞ËÆ∞">Ë∫´‰∏äË¢´Áïô‰∏ãÂç∞ËÆ∞</div>
                  <div class="option-btn" data-value="Ë¢´ÂÆ°ÈóÆÂºèÂØπËØù">Ë¢´ÂÆ°ÈóÆÂºèÂØπËØù</div>
                  <div class="option-btn" data-value="Ë¢´ÂâÉÊØõ">Ë¢´ÂâÉÊØõ</div>
                  <div class="option-btn" data-value="Ë¢´ÁÅåËÇ†">Ë¢´ÁÅåËÇ†</div>
                  <div class="option-btn" data-value="Ë¢´Á¶ÅÊ≠¢È´òÊΩÆ">Ë¢´Á¶ÅÊ≠¢È´òÊΩÆ</div>
                  <div class="option-btn" data-value="ËßíËâ≤ÊâÆÊºî">ËßíËâ≤ÊâÆÊºî</div>
                  <div class="option-btn" data-value="Âπ¥ÈæÑÊâÆÊºî">Âπ¥ÈæÑÊâÆÊºî</div>
                  <div class="option-btn" data-value="Âà∂ÊúçËØ±ÊÉë">Âà∂ÊúçËØ±ÊÉë</div>
                  <div class="option-btn" data-value="ÊÅãÁâ©(ÁâπÂÆöÁâ©ÂìÅÊàñÊùêË¥®Â¶Ç‰∏ùË¢ú/ÁöÆÈù©/‰π≥ËÉ∂)">
                    ÊÅãÁâ©(ÁâπÂÆöÁâ©ÂìÅÊàñÊùêË¥®Â¶Ç‰∏ùË¢ú/ÁöÆÈù©/‰π≥ËÉ∂)
                  </div>
                  <div class="option-btn" data-value="ÊÅãË∂≥">ÊÅãË∂≥</div>
                  <div class="option-btn" data-value="ÊÅãÊâã">ÊÅãÊâã</div>
                  <div class="option-btn" data-value="ÁñºÁóõÊ∏∏Êàè(ÁóõÊÑü‰∏éÂø´ÊÑüÊ®°Á≥ä)">ÁñºÁóõÊ∏∏Êàè(ÁóõÊÑü‰∏éÂø´ÊÑüÊ®°Á≥ä)</div>
                  <div class="option-btn" data-value="Âú®ÂÖ¨ÂÖ±ÊàñÂçäÂÖ¨ÂÖ±Âú∫ÊâÄ">Âú®ÂÖ¨ÂÖ±ÊàñÂçäÂÖ¨ÂÖ±Âú∫ÊâÄ</div>
                  <div class="option-btn" data-value="Êö¥Èú≤Ëá™Â∑±ÁöÑË∫´‰Ωì">Êö¥Èú≤Ëá™Â∑±ÁöÑË∫´‰Ωì</div>
                  <div class="option-btn" data-value="Á™•ËßÜ‰ªñ‰∫∫">Á™•ËßÜ‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="Ë¢´Á™•ËßÜ">Ë¢´Á™•ËßÜ</div>
                  <div class="option-btn" data-value="ÁîµËØùÊàñËØ≠Èü≥ÊÄßÁà±">ÁîµËØùÊàñËØ≠Èü≥ÊÄßÁà±</div>
                  <div class="option-btn" data-value="ÂΩïÂÉèÊàñÊãçÁÖß">ÂΩïÂÉèÊàñÊãçÁÖß</div>
                  <div class="option-btn" data-value="Â§ö‰∫∫Ë°å">Â§ö‰∫∫Ë°å</div>
                  <div class="option-btn" data-value="NTR(‰º¥‰æ£‰∏é‰ªñ‰∫∫ÂèëÁîüÂÖ≥Á≥ª)">NTR(‰º¥‰æ£‰∏é‰ªñ‰∫∫ÂèëÁîüÂÖ≥Á≥ª)</div>
                  <div class="option-btn" data-value="Ë¢´NTR">Ë¢´NTR</div>
                  <div class="option-btn" data-value="‰ΩìÂûãÂ∑Æ">‰ΩìÂûãÂ∑Æ</div>
                  <div class="option-btn" data-value="ÂäõÈáèÂ∑Æ">ÂäõÈáèÂ∑Æ</div>
                  <div class="option-btn" data-value="ËÑèËØù">ËÑèËØù</div>
                  <div class="option-btn" data-value="ÁúºÊ≥™">ÁúºÊ≥™</div>
                  <div class="option-btn" data-value="Ê±óÊ∞¥">Ê±óÊ∞¥</div>
                  <div class="option-btn" data-value="Ê∞îÂë≥">Ê∞îÂë≥</div>
                  <div class="option-btn" data-value="Ëú°ÁÉõÊàñÂÜ∞Âùó(Ê∏©Â∫¶Ê∏∏Êàè)">Ëú°ÁÉõÊàñÂÜ∞Âùó(Ê∏©Â∫¶Ê∏∏Êàè)</div>
                  <div class="option-btn" data-value="È£üÁâ©(Â∞ÜÈ£üÁâ©Áî®‰∫éË∫´‰Ωì)">È£üÁâ©(Â∞ÜÈ£üÁâ©Áî®‰∫éË∫´‰Ωì)</div>
                  <div class="option-btn" data-value="Á™íÊÅØÊ∏∏Êàè(ÂëºÂê∏ÊéßÂà∂)">Á™íÊÅØÊ∏∏Êàè(ÂëºÂê∏ÊéßÂà∂)</div>
                  <div class="option-btn" data-value="Ê∞¥‰∏≠Â¨âÊàè">Ê∞¥‰∏≠Â¨âÊàè</div>
                  <div class="option-btn" data-value="Áù°Áú†‰æµÁäØ(Âú®ÂØπÊñπÁù°ÁùÄÊó∂)">Áù°Áú†‰æµÁäØ(Âú®ÂØπÊñπÁù°ÁùÄÊó∂)</div>
                  <div class="option-btn" data-value="Âè£‰∫§">Âè£‰∫§</div>
                  <div class="option-btn" data-value="Êâã‰∫§">Êâã‰∫§</div>
                  <div class="option-btn" data-value="‰π≥‰∫§">‰π≥‰∫§</div>
                  <div class="option-btn" data-value="Ë∂≥‰∫§">Ë∂≥‰∫§</div>
                  <div class="option-btn" data-value="Â≠êÂÆ´‰∫§">Â≠êÂÆ´‰∫§</div>
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="kinksCustom"
                  placeholder="Ëá™ÂÆö‰πâÊÄßÁôñÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- Áà±Â•Ω -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="hobbiesSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('hobbies')">
                <div>
                  <span>Áà±Â•Ω</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('hobbies')">‚öÖ</span>
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('hobbies')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="hobbiesSelected"></div>
              <div class="collapsible-content collapsed" id="hobbiesContent">
                <div class="options-grid" id="hobbiesGrid">
                  <div class="option-btn" data-value="ÈòÖËØª">ÈòÖËØª</div>
                  <div class="option-btn" data-value="ÁîµÂΩ±">ÁîµÂΩ±</div>
                  <div class="option-btn" data-value="Âê¨Èü≥‰πê">Âê¨Èü≥‰πê</div>
                  <div class="option-btn" data-value="ÂÅöÈü≥‰πê">ÂÅöÈü≥‰πê</div>
                  <div class="option-btn" data-value="ÂÜô‰Ωú">ÂÜô‰Ωú</div>
                  <div class="option-btn" data-value="ÁªòÁîª">ÁªòÁîª</div>
                  <div class="option-btn" data-value="ÊëÑÂΩ±">ÊëÑÂΩ±</div>
                  <div class="option-btn" data-value="ÁÉπÈ•™">ÁÉπÈ•™</div>
                  <div class="option-btn" data-value="ÁÉòÁÑô">ÁÉòÁÑô</div>
                  <div class="option-btn" data-value="ËøêÂä®">ËøêÂä®</div>
                  <div class="option-btn" data-value="ÂÅ•Ë∫´">ÂÅ•Ë∫´</div>
                  <div class="option-btn" data-value="Ë∑ëÊ≠•">Ë∑ëÊ≠•</div>
                  <div class="option-btn" data-value="Ê∏∏Ê≥≥">Ê∏∏Ê≥≥</div>
                  <div class="option-btn" data-value="ÁØÆÁêÉ">ÁØÆÁêÉ</div>
                  <div class="option-btn" data-value="Ë∂≥ÁêÉ">Ë∂≥ÁêÉ</div>
                  <div class="option-btn" data-value="ÊûÅÈôêËøêÂä®">ÊûÅÈôêËøêÂä®</div>
                  <div class="option-btn" data-value="ËàûËπà">ËàûËπà</div>
                  <div class="option-btn" data-value="‰πêÂô®ÊºîÂ•è">‰πêÂô®ÊºîÂ•è</div>
                  <div class="option-btn" data-value="ÊàèÂâßË°®Êºî">ÊàèÂâßË°®Êºî</div>
                  <div class="option-btn" data-value="ÊóÖË°å">ÊóÖË°å</div>
                  <div class="option-btn" data-value="ÂæíÊ≠•">ÂæíÊ≠•</div>
                  <div class="option-btn" data-value="Èú≤Ëê•">Èú≤Ëê•</div>
                  <div class="option-btn" data-value="ÈíìÈ±º">ÈíìÈ±º</div>
                  <div class="option-btn" data-value="Âõ≠Ëâ∫">Âõ≠Ëâ∫</div>
                  <div class="option-btn" data-value="ÊâãÂ∑•Ëâ∫">ÊâãÂ∑•Ëâ∫</div>
                  <div class="option-btn" data-value="Ê®°ÂûãÂà∂‰Ωú">Ê®°ÂûãÂà∂‰Ωú</div>
                  <div class="option-btn" data-value="ÁîµÂ≠êÊ∏∏Êàè">ÁîµÂ≠êÊ∏∏Êàè</div>
                  <div class="option-btn" data-value="Ê°åÊ∏∏">Ê°åÊ∏∏</div>
                  <div class="option-btn" data-value="ÂìÅËå∂">ÂìÅËå∂</div>
                  <div class="option-btn" data-value="ÂìÅÈÖí">ÂìÅÈÖí</div>
                  <div class="option-btn" data-value="Êî∂Ëóè(ÈÇÆÁ•®/Á°¨Â∏ÅÁ≠â)">Êî∂Ëóè(ÈÇÆÁ•®/Á°¨Â∏ÅÁ≠â)</div>
                  <div class="option-btn" data-value="Á†îÁ©∂ÂéÜÂè≤">Á†îÁ©∂ÂéÜÂè≤</div>
                  <div class="option-btn" data-value="Á†îÁ©∂Âì≤Â≠¶">Á†îÁ©∂Âì≤Â≠¶</div>
                  <div class="option-btn" data-value="Â≠¶‰π†Â§ñËØ≠">Â≠¶‰π†Â§ñËØ≠</div>
                  <div class="option-btn" data-value="ÁúãÂä®Êº´">ÁúãÂä®Êº´</div>
                  <div class="option-btn" data-value="ËøΩÂâß">ËøΩÂâß</div>
                  <div class="option-btn" data-value="ÈÄõÂçöÁâ©È¶Ü">ÈÄõÂçöÁâ©È¶Ü</div>
                  <div class="option-btn" data-value="ÂøóÊÑøËÄÖÊ¥ªÂä®">ÂøóÊÑøËÄÖÊ¥ªÂä®</div>
                  <div class="option-btn" data-value="ÊäïËµÑÁêÜË¥¢">ÊäïËµÑÁêÜË¥¢</div>
                  <div class="option-btn" data-value="ËµõËΩ¶">ËµõËΩ¶</div>
                  <div class="option-btn" data-value="ÊΩúÊ∞¥">ÊΩúÊ∞¥</div>
                  <div class="option-btn" data-value="ÊªëÈõ™">ÊªëÈõ™</div>
                  <div class="option-btn" data-value="ÊÄßÁà±">ÊÄßÁà±</div>
                  <div class="option-btn" data-value="Ëá™ÊÖ∞">Ëá™ÊÖ∞</div>
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="hobbiesCustom"
                  placeholder="Ëá™ÂÆö‰πâÁà±Â•ΩÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>

          <!-- ÊïèÊÑüÁÇπ -->
          <div class="form-group full-width">
            <div class="collapsible-section" id="sensitiveSpotsSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('sensitiveSpots')">
                <div>
                  <span>ÊïèÊÑüÁÇπ</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeField('sensitiveSpots')"
                    >‚öÖ</span
                  >
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('sensitiveSpots')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="sensitiveSpotsSelected"></div>
              <div class="collapsible-content collapsed" id="sensitiveSpotsContent">
                <div class="options-grid" id="sensitiveSpotsGrid">
                  <div class="option-btn" data-value="Âò¥Âîá">Âò¥Âîá</div>
                  <div class="option-btn" data-value="ËàåÂ§¥">ËàåÂ§¥</div>
                  <div class="option-btn" data-value="ËÑñÈ¢à">ËÑñÈ¢à</div>
                  <div class="option-btn" data-value="ÂêéÈ¢à">ÂêéÈ¢à</div>
                  <div class="option-btn" data-value="ÈîÅÈ™®">ÈîÅÈ™®</div>
                  <div class="option-btn" data-value="ËÄ≥ÂûÇ">ËÄ≥ÂûÇ</div>
                  <div class="option-btn" data-value="ËÑäÊ§é">ËÑäÊ§é</div>
                  <div class="option-btn" data-value="ËÖ∞Á™ù">ËÖ∞Á™ù</div>
                  <div class="option-btn" data-value="‰æßËÖ∞">‰æßËÖ∞</div>
                  <div class="option-btn" data-value="Â∞èËÖπ">Â∞èËÖπ</div>
                  <div class="option-btn" data-value="Â§ßËÖøÂÜÖ‰æß">Â§ßËÖøÂÜÖ‰æß</div>
                  <div class="option-btn" data-value="ËÑöË∏ù">ËÑöË∏ù</div>
                  <div class="option-btn" data-value="ËÑöÂøÉ">ËÑöÂøÉ</div>
                  <div class="option-btn" data-value="ËÉ∏Âè£">ËÉ∏Âè£</div>
                  <div class="option-btn" data-value="‰π≥Â§¥">‰π≥Â§¥</div>
                  <div class="option-btn" data-value="ËÇöËÑê">ËÇöËÑê</div>
                  <div class="option-btn" data-value="ËáÄÈÉ®">ËáÄÈÉ®</div>
                  <div class="option-btn" data-value="Èò¥ËíÇ">Èò¥ËíÇ</div>
                  <div class="option-btn" data-value="Á©¥Âè£">Á©¥Âè£</div>
                  <div class="option-btn" data-value="GÁÇπ">GÁÇπ</div>
                  <div class="option-btn" data-value="Â≠êÂÆ´Âè£">Â≠êÂÆ´Âè£</div>
                  <div class="option-btn" data-value="Â≠êÂÆ´ÂÜÖÂ£Å">Â≠êÂÆ´ÂÜÖÂ£Å</div>
                  <div class="option-btn" data-value="ÂêéÁ©¥Âè£">ÂêéÁ©¥Âè£</div>
                  <div class="option-btn" data-value="ÂâçÂàóËÖ∫">ÂâçÂàóËÖ∫</div>
                  <div class="option-btn" data-value="ÁªìËÇ†Âè£">ÁªìËÇ†Âè£</div>
                  <div class="option-btn" data-value="Èò¥Ëåé">Èò¥Ëåé</div>
                  <div class="option-btn" data-value="ÈæüÂ§¥">ÈæüÂ§¥</div>
                  <div class="option-btn" data-value="È©¨Áúº">È©¨Áúº</div>
                  <div class="option-btn" data-value="Â∞øÈÅì">Â∞øÈÅì</div>
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="sensitiveSpotsCustom"
                  placeholder="Ëá™ÂÆö‰πâÊïèÊÑüÁÇπÔºàÁî®ÈÄóÂè∑ÂàÜÈöîÔºâ"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- ÁªèÂéÜ -->
        <div class="form-section">
          <div class="form-group full-width">
            <div class="form-label">
              <span class="crown-icon"></span>
              ÁªèÂéÜ
              <span class="icon dice-icon" onclick="randomizeAllExperience()">‚öÖ</span>
            </div>

            <!-- Ë∫´‰ªΩ -->
            <div class="collapsible-section" id="identitySection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('identity')">
                <div>
                  <span>Ë∫´‰ªΩ</span>
                  <span class="icon dice-icon" onclick="event.stopPropagation(); randomizeExperienceField('identity')"
                    >‚öÖ</span
                  >
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('identity')">üñã</span>
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="identitySelected"></div>
              <div class="collapsible-content collapsed" id="identityContent">
                <div class="options-grid single-select" id="identityGrid">
                  <div class="option-btn" data-value="ÊòéÊòü">ÊòéÊòü</div>
                  <div class="option-btn" data-value="Ë±™Èó®ÁªßÊâø‰∫∫">Ë±™Èó®ÁªßÊâø‰∫∫</div>
                  <div class="option-btn" data-value="Ë±™Èó®ÁßÅÁîüÂ≠ê">Ë±™Èó®ÁßÅÁîüÂ≠ê</div>
                  <div class="option-btn" data-value="Â§ßÂ≠¶Áîü">Â§ßÂ≠¶Áîü</div>
                  <div class="option-btn" data-value="ÁΩëÁ∫¢‰∏ªÊí≠">ÁΩëÁ∫¢‰∏ªÊí≠</div>
                  <div class="option-btn" data-value="Ê®°Áâπ">Ê®°Áâπ</div>
                  <div class="option-btn" data-value="ÊÄªË£Å">ÊÄªË£Å</div>
                  <div class="option-btn" data-value="ÊäïËµÑ‰∫∫">ÊäïËµÑ‰∫∫</div>
                  <div class="option-btn" data-value="Âàõ‰∏öËÄÖ">Âàõ‰∏öËÄÖ</div>
                  <div class="option-btn" data-value="ÁîúÁÇπÂ∏à">ÁîúÁÇπÂ∏à</div>
                  <div class="option-btn" data-value="ÂÅ•Ë∫´ÊïôÁªÉ">ÂÅ•Ë∫´ÊïôÁªÉ</div>
                  <div class="option-btn" data-value="Â∑•Á®ãÂ∏à">Â∑•Á®ãÂ∏à</div>
                  <div class="option-btn" data-value="Ê∏∏ÊàèÁ≠ñÂàí">Ê∏∏ÊàèÁ≠ñÂàí</div>
                  <div class="option-btn" data-value="ÂåªÁîü">ÂåªÁîü</div>
                  <div class="option-btn" data-value="Êä§Â£´">Êä§Â£´</div>
                  <div class="option-btn" data-value="ËµõËΩ¶Êâã">ËµõËΩ¶Êâã</div>
                  <div class="option-btn" data-value="Ê≤°ËêΩË¥µÊóè">Ê≤°ËêΩË¥µÊóè</div>
                  <div class="option-btn" data-value="Ê£ÄÂØüÂÆò">Ê£ÄÂØüÂÆò</div>
                  <div class="option-btn" data-value="Èõá‰Ω£ÂÖµ">Èõá‰Ω£ÂÖµ</div>
                  <div class="option-btn" data-value="Ë≠¶ÂØü">Ë≠¶ÂØü</div>
                  <div class="option-btn" data-value="ÂæãÂ∏à">ÂæãÂ∏à</div>
                  <div class="option-btn" data-value="Á®ãÂ∫èÂëò">Á®ãÂ∫èÂëò</div>
                  <div class="option-btn" data-value="ÈªëÂÆ¢">ÈªëÂÆ¢</div>
                  <div class="option-btn" data-value="ÂØºÊºî">ÂØºÊºî</div>
                  <div class="option-btn" data-value="ÁîªÂÆ∂">ÁîªÂÆ∂</div>
                  <div class="option-btn" data-value="Èü≥‰πêÂÆ∂">Èü≥‰πêÂÆ∂</div>
                  <div class="option-btn" data-value="ËøêÂä®Âëò">ËøêÂä®Âëò</div>
                  <div class="option-btn" data-value="ÁîµÁ´ûÈÄâÊâã">ÁîµÁ´ûÈÄâÊâã</div>
                  <div class="option-btn" data-value="ËÄÅÂ∏à">ËÄÅÂ∏à</div>
                  <div class="option-btn" data-value="Ë∞ÉÈÖíÂ∏à">Ë∞ÉÈÖíÂ∏à</div>
                  <div class="option-btn" data-value="Âé®Â∏à">Âé®Â∏à</div>
                  <div class="option-btn" data-value="ÁæéÈ£üËØÑËÆ∫ÂÆ∂">ÁæéÈ£üËØÑËÆ∫ÂÆ∂</div>
                  <div class="option-btn" data-value="ÊóÖË°åÂÆ∂">ÊóÖË°åÂÆ∂</div>
                  <div class="option-btn" data-value="ËÄÉÂè§Â≠¶ÂÆ∂">ËÄÉÂè§Â≠¶ÂÆ∂</div>
                  <div class="option-btn" data-value="ÊëÑÂΩ±Â∏à">ÊëÑÂΩ±Â∏à</div>
                  <div class="option-btn" data-value="Ê∂àÈò≤Âëò">Ê∂àÈò≤Âëò</div>
                </div>
                <input type="text" class="form-input custom-input" id="identityCustom" placeholder="Ëá™ÂÆö‰πâË∫´‰ªΩ" />
              </div>
            </div>

            <!-- ÊÉÖÊÑüÁä∂ÊÄÅ -->
            <div class="collapsible-section" id="relationshipStatusSection">
              <div class="collapsible-header collapsed" onclick="toggleCollapse('relationshipStatus')">
                <div>
                  <span>ÊÉÖÊÑüÁä∂ÊÄÅ</span>
                  <span
                    class="icon dice-icon"
                    onclick="event.stopPropagation(); randomizeExperienceField('relationshipStatus')"
                    >‚öÖ</span
                  >
                  <span class="icon edit-icon" onclick="event.stopPropagation(); editCustom('relationshipStatus')"
                    >üñã</span
                  >
                </div>
                <span class="expand-icon">‚ñº</span>
              </div>
              <div class="selected-items" id="relationshipStatusSelected"></div>
              <div class="collapsible-content collapsed" id="relationshipStatusContent">
                <div class="options-grid single-select" id="relationshipStatusGrid">
                  <div class="option-btn" data-value="ÊØçËÉéÂçïË∫´">ÊØçËÉéÂçïË∫´</div>
                  <div class="option-btn" data-value="ÂçïË∫´">ÂçïË∫´</div>
                  <div class="option-btn" data-value="ÊöóÊÅã‰∏≠">ÊöóÊÅã‰∏≠</div>
                  <div class="option-btn" data-value="ÂàöÂàöÂ§±ÊÅã">ÂàöÂàöÂ§±ÊÅã</div>
                  <div class="option-btn" data-value="Á®≥ÂÆöÊÅãÁà±‰∏≠">Á®≥ÂÆöÊÅãÁà±‰∏≠</div>
                  <div class="option-btn" data-value="Â∑≤ËÆ¢Â©ö">Â∑≤ËÆ¢Â©ö</div>
                  <div class="option-btn" data-value="ÁßòÂØÜÂ∑≤Â©ö">ÁßòÂØÜÂ∑≤Â©ö</div>
                  <div class="option-btn" data-value="ÂêàÁ∫¶Â©öÂßª">ÂêàÁ∫¶Â©öÂßª</div>
                  <div class="option-btn" data-value="ÂºÄÊîæÂºèÂÖ≥Á≥ª">ÂºÄÊîæÂºèÂÖ≥Á≥ª</div>
                  <div class="option-btn" data-value="Ê≠£Âú®ÂäûÁêÜÁ¶ªÂ©ö">Ê≠£Âú®ÂäûÁêÜÁ¶ªÂ©ö</div>
                  <div class="option-btn" data-value="Â∑≤Á¶ªÂºÇ">Â∑≤Á¶ªÂºÇ</div>
                  <div class="option-btn" data-value="‰∏ßÂÅ∂">‰∏ßÂÅ∂</div>
                  <div class="option-btn" data-value="ÁÇÆÂèãÂÖ≥Á≥ª">ÁÇÆÂèãÂÖ≥Á≥ª</div>
                  <div class="option-btn" data-value="Ë¢´Ââç‰ªªÁ∫†Áº†">Ë¢´Ââç‰ªªÁ∫†Áº†</div>
                  <div class="option-btn" data-value="ÂøÉ‰∏≠ÊúâÁôΩÊúàÂÖâ">ÂøÉ‰∏≠ÊúâÁôΩÊúàÂÖâ</div>
                  <div class="option-btn" data-value="Ê∏¥ÊúõË¢´ÂåÖÂÖª">Ê∏¥ÊúõË¢´ÂåÖÂÖª</div>
                  <div class="option-btn" data-value="Ê≠£Âú®ÂåÖÂÖª‰ªñ‰∫∫">Ê≠£Âú®ÂåÖÂÖª‰ªñ‰∫∫</div>
                  <div class="option-btn" data-value="ÂÅáË£ÖÂçïË∫´">ÂÅáË£ÖÂçïË∫´</div>
                  <div class="option-btn" data-value="ÁÇícp‰∏≠">ÁÇícp‰∏≠</div>
                  <div class="option-btn" data-value="Êµ∑Áéã">Êµ∑Áéã</div>
                  <div class="option-btn" data-value="Êµ∑Âêé">Êµ∑Âêé</div>
                </div>
                <input
                  type="text"
                  class="form-input custom-input"
                  id="relationshipStatusCustom"
                  placeholder="Ëá™ÂÆö‰πâÊÉÖÊÑüÁä∂ÊÄÅ"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- ÂÖ∂‰ªñËá™ÂÆö‰πâ -->
        <div class="form-group full-width other-custom-section">
          <div class="form-label">ÂÖ∂‰ªñËá™ÂÆö‰πâ</div>
          <div style="margin-bottom: 10px">
            <div class="form-label" style="margin-bottom: 5px; font-size: 13px">Ë°•ÂÖÖËØ¥Êòé</div>
            <textarea
              class="form-input"
              id="additionalInfo"
              style="min-height: 60px; resize: vertical"
              placeholder="Âú®ËøôÈáåÊ∑ªÂä†‰ªª‰ΩïÂÖ∂‰ªñÊÉ≥Ë¶ÅËØ¥ÊòéÁöÑ‰ø°ÊÅØÔºåÊØîÂ¶ÇÁâπÊÆäÁªèÂéÜ„ÄÅÁà±Â•Ω„ÄÅ‰π†ÊÉØÁ≠â..."
            ></textarea>
          </div>
        </div>

        <!-- Â∫ïÈÉ®ÊåâÈíÆ -->
        <div class="bottom-actions">
          <button class="action-btn" onclick="randomizeAll()">üìö ÈöèÊú∫ÁîüÊàêÂÖ®ÈÉ®</button>
          <button class="action-btn primary" onclick="confirmCreate()">‚ú® ÁîüÊàêËßíËâ≤Êï∞ÊçÆ ‚ú®</button>
        </div>

        <div class="completion-text">ÁîüÊàêÂÆåÊàêÂêéÔºåÊÇ®Â∞ÜËé∑ÂæóÂÆåÊï¥ÁöÑYAMLÊ†ºÂºèËßíËâ≤Êï∞ÊçÆ</div>
      </div>

      <!-- ËØ¥ÊòéÈ°µÈù¢ -->
      <div class="main-panel instruction-panel" id="instructionPanel" style="display: none">
        <h1 class="title">‚ú® ÁîüÊàêÂÆåÊàê ‚ú®</h1>

        <div class="instruction-content">
          <div class="important-steps">
            <div class="step-item urgent">
              <div class="step-number">1</div>
              <div class="step-text">ËßíËâ≤Êï∞ÊçÆÂ∑≤ÁîüÊàêÂÆåÊàêÔºåÊÇ®ÂèØ‰ª• <strong>Â§çÂà∂YAMLÊï∞ÊçÆ</strong> Êàñ <strong>‰∏ãËΩΩÊñá‰ª∂</strong></div>
            </div>

            <div class="step-item urgent">
              <div class="step-number">2</div>
              <div class="step-text">Â∞ÜËßíËâ≤Êï∞ÊçÆÂØºÂÖ•Âà∞ÊÇ®ÈúÄË¶ÅÁöÑÂπ≥Âè∞ÊàñÂ∑•ÂÖ∑‰∏≠‰ΩøÁî®</div>
            </div>

            <div class="step-item warning">
              <div class="step-icon">üí°</div>
              <div class="step-text">YAMLÊ†ºÂºèÁöÑËßíËâ≤Êï∞ÊçÆÂèØ‰ª•Âú®ÂêÑÁßçËÅäÂ§©Êú∫Âô®‰∫∫„ÄÅÊ∏∏ÊàèÊàñÂàõ‰ΩúÂ∑•ÂÖ∑‰∏≠‰ΩøÁî®</div>
            </div>
          </div>

          <div class="thank-you-section">
            <div class="thank-you-text">
              <p>ÊÑüË∞¢‰ΩøÁî®ÈÄöÁî®ËßíËâ≤ÁîüÊàêÂô®</p>
              <p>Â∏åÊúõËøô‰∏™Â∑•ÂÖ∑ËÉΩÂ§üÂ∏ÆÂä©ÊÇ®ÁöÑÂàõ‰Ωú</p>
              <p>Ê¨¢ËøéÂèçÈ¶à‰ΩøÁî®‰ΩìÈ™åÂíåÊîπËøõÂª∫ËÆÆ</p>
              <p>ËßíËâ≤ÁîüÊàêÂô®ÂºÄÊ∫êÂÖçË¥πÔºåÁ¶ÅÊ≠¢ÂïÜÁî®„ÄÇ</p>
            </div>

            <div class="author-signature">
              <div class="signature-text">Âü∫‰∫éÂéüÁâà‰øÆÊîπ - ÈÄöÁî®ËßíËâ≤ÁîüÊàêÂô®</div>
            </div>
          </div>

          <div class="decoration-stars">
            <span class="star-decoration">‚ú®</span>
            <span class="star-decoration">‚≠ê</span>
            <span class="star-decoration">‚ú®</span>
            <span class="star-decoration">‚≠ê</span>
            <span class="star-decoration">‚ú®</span>
          </div>
        </div>
      </div>
    </div>

    <!-- YAMLÁªìÊûúÊòæÁ§∫Á™óÂè£ -->
    <div id="yamlModal" class="yaml-modal" style="display: none;">
      <div class="yaml-modal-content">
        <div class="yaml-modal-header">
          <h2>ËßíËâ≤Êï∞ÊçÆ (YAMLÊ†ºÂºè)</h2>
          <span class="yaml-modal-close">&times;</span>
        </div>
        <div class="yaml-modal-body">
          <textarea id="yamlOutput" readonly></textarea>
          <div class="yaml-modal-actions">
            <button id="copyYamlBtn" class="action-btn">üìã Â§çÂà∂YAML</button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/options-config.js"></script>
    <script src="js/worlds-config.js"></script>
    <script src="js/js-yaml.min.js"></script>
    <script>
      // ÂÖ®Â±ÄÂèòÈáè
      let currentWorld = 'modern'; // ÈªòËÆ§‰∏ñÁïå
      let currentWorldConfig = null;
      
      // ‰ªéURLÂèÇÊï∞Ëé∑Âèñ‰∏ñÁïåËÉåÊôØ
      function getWorldFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        const world = urlParams.get('world');
        return world && WORLDS_CONFIG[world] ? world : 'modern';
      }
      
      // Â∫îÁî®‰∏ñÁïåËÉåÊôØ‰∏ªÈ¢ò
      function applyWorldTheme(worldKey) {
        const world = WORLDS_CONFIG[worldKey];
        if (!world) return;
        
        currentWorld = worldKey;
        currentWorldConfig = world;
        
        // Êõ¥Êñ∞CSSÂèòÈáè
        const root = document.documentElement;
        const colors = world.color;
        
        // Ëß£ÊûêËÉåÊôØÊ∏êÂèò‰∏≠ÁöÑÈ¢úËâ≤
        const gradientMatch = colors.background.match(/linear-gradient\([^)]+\)/);
        if (gradientMatch) {
          // ÊèêÂèñÊ∏êÂèò‰∏≠ÁöÑÈ¢úËâ≤ÂÄº
          const colorMatches = colors.background.match(/#[a-fA-F0-9]{6}/g);
          if (colorMatches && colorMatches.length >= 3) {
            root.style.setProperty('--primary-color', colorMatches[0]);
            root.style.setProperty('--primary-dark', colorMatches[1]);
            root.style.setProperty('--primary-darker', colorMatches[2]);
            root.style.setProperty('--panel-bg', colorMatches[0]);
          }
        }
        
        root.style.setProperty('--secondary-color', colors.secondary);
        root.style.setProperty('--accent-color', colors.accent);
        
        // Êõ¥Êñ∞ËÉåÊôØ
        document.body.style.background = colors.background;
        
        // Êõ¥Êñ∞È°µÈù¢ÂÖÉÁ¥†
        document.getElementById('worldIcon').textContent = world.icon;
        document.getElementById('worldName').textContent = world.name;
        document.getElementById('pageTitle').textContent = `‚ú® ${world.name} - ËßíËâ≤ÁîüÊàêÂô® ‚ú®`;
        
        // Êõ¥Êñ∞Ë£ÖÈ•∞ÊòüÊòü
        updateDecorations(world.decorations);
        
        // Êõ¥Êñ∞ÈÄâÈ°πÈÖçÁΩÆ
        updateWorldSpecificOptions(worldKey);
      }
      
      // Êõ¥Êñ∞Ë£ÖÈ•∞ÂÖÉÁ¥†
      function updateDecorations(decorations) {
        const stars = document.querySelectorAll('.star');
        stars.forEach((star, index) => {
          if (decorations[index % decorations.length]) {
            star.textContent = decorations[index % decorations.length];
          }
        });
      }
      
      // Êõ¥Êñ∞ÊÄßÂà´ÁâπÂÆöÁöÑ‰∏ãÊãâÊ°ÜÈÄâÈ°π
      function updateGenderSpecificSelects(gender) {
        const world = WORLDS_CONFIG[currentWorld];
        if (!world) return;
        
        const selectMappings = {
          'dressStyle': 'dressStyle',
          'hairStyle': 'hairstyle', 
          'accessories': 'accessories',
          'illness': 'illness',
          'characterTrait': 'specialTraits',
          'bodyScent': 'bodyScent'
        };
        
        Object.keys(selectMappings).forEach(selectId => {
          const configKey = selectMappings[selectId];
          if (world[configKey] && world[configKey].options && world[configKey].genderSpecific) {
            const options = getOptionsForGender(world[configKey].options, gender);
            updateSelectOptions(selectId, options);
          }
        });
      }
      
      // ËæÖÂä©ÂáΩÊï∞ÔºöÊ†πÊçÆÊÄßÂà´Ëé∑ÂèñÈÄâÈ°πÔºàÁî®‰∫é‰∏ãÊãâÊ°ÜÔºâ
      function getOptionsForGender(optionsConfig, gender) {
        if (!optionsConfig || typeof optionsConfig !== 'object') {
          return [];
        }
        
        // Â¶ÇÊûúoptionsÊòØÊï∞ÁªÑÔºåÁõ¥Êé•ËøîÂõû
        if (Array.isArray(optionsConfig)) {
          return optionsConfig;
        }
        
        // Â§ÑÁêÜÊÄßÂà´ÁâπÂÆöÈÖçÁΩÆ
        const genderKey = GENDER_MAPPING[gender] || null;
        
        // Â¶ÇÊûúÊÄßÂà´‰∏∫Á©∫„ÄÅÊú™Áü•ÊàñÊò†Â∞Ñ‰∏∫'all'ÔºåÊòæÁ§∫ÊâÄÊúâÈÄâÈ°πÔºàÂêàÂπ∂ÂéªÈáçÔºâ
        if (!gender || !genderKey || genderKey === 'all') {
          const allOptions = [];
          Object.keys(optionsConfig).forEach(key => {
            if (Array.isArray(optionsConfig[key])) {
              allOptions.push(...optionsConfig[key]);
            }
          });
          // ÂéªÈáçÂπ∂ËøîÂõû
          return [...new Set(allOptions)];
        }
        
        // ËøîÂõûÁâπÂÆöÊÄßÂà´ÁöÑÈÄâÈ°πÔºåÂåÖÊã¨commonÈÄâÈ°π
        let specificOptions = [];
        if (optionsConfig[genderKey] && Array.isArray(optionsConfig[genderKey])) {
          specificOptions.push(...optionsConfig[genderKey]);
        }
        if (optionsConfig.common && Array.isArray(optionsConfig.common)) {
          specificOptions.push(...optionsConfig.common);
        }
        
        return [...new Set(specificOptions)];
      }
      
      // Êõ¥Êñ∞‰∏ñÁïåÁâπÂÆöÁöÑÈÄâÈ°π
      function updateWorldSpecificOptions(worldKey) {
        const world = WORLDS_CONFIG[worldKey];
        if (!world) return;
        
        // Â∞Ü‰∏ñÁïåÁâπÂÆöÈÖçÁΩÆË¶ÜÁõñÂà∞CHARACTER_OPTIONS_CONFIG‰∏≠
        Object.keys(world).forEach(key => {
          if (typeof world[key] === 'object' && world[key].type) {
            CHARACTER_OPTIONS_CONFIG[key] = world[key];
          }
        });
        
        // Êõ¥Êñ∞Ë∫´‰ªΩÈÄâÈ°π
        if (world.identity && world.identity.options) {
          updateSelectOptions('identity', world.identity.options);
        }
        
        // Êõ¥Êñ∞ÂÖ∂‰ªñ‰∏ãÊãâÊ°ÜÈÄâÈ°π
        const selectMappings = {
          'dressStyle': 'dressStyle',
          'hairStyle': 'hairstyle', 
          'accessories': 'accessories',
          'illness': 'illness',
          'characterTrait': 'specialTraits',
          'bodyScent': 'bodyScent'
        };
        
        Object.keys(selectMappings).forEach(selectId => {
          const configKey = selectMappings[selectId];
          if (world[configKey] && world[configKey].options) {
            // Â§ÑÁêÜÊÄßÂà´ÁâπÂÆöÈÄâÈ°π
            if (world[configKey].genderSpecific) {
              const currentGender = getCurrentGender();
              const options = getOptionsForGender(world[configKey].options, currentGender);
              updateSelectOptions(selectId, options);
            } else {
              updateSelectOptions(selectId, world[configKey].options);
            }
          }
        });
        
        // ÈáçÊñ∞ÂàùÂßãÂåñÊâÄÊúâÈÄâÈ°πÁªÑ‰ª•Â∫îÁî®Êñ∞ÈÖçÁΩÆ
        initializeAllOptionGroups();
      }
      
      // Êõ¥Êñ∞‰∏ãÊãâÈÄâÊã©Ê°ÜÈÄâÈ°π
      function updateSelectOptions(selectId, options) {
        const select = document.getElementById(selectId);
        if (!select) return;
        
        // ‰øùÂ≠òÂΩìÂâçÈÄâ‰∏≠ÁöÑÂÄº
        const currentValue = select.value;
        
        // Ê∏ÖÁ©∫Áé∞ÊúâÈÄâÈ°πÔºà‰øùÁïôÁ¨¨‰∏Ä‰∏™Á©∫ÈÄâÈ°πÔºâ
        const firstOption = select.querySelector('option[value=""]');
        select.innerHTML = '';
        if (firstOption) {
          select.appendChild(firstOption);
        }
        
        // Ê∑ªÂä†Êñ∞ÈÄâÈ°π
        options.forEach(option => {
          const optionElement = document.createElement('option');
          optionElement.value = option;
          optionElement.textContent = option;
          select.appendChild(optionElement);
        });
        
        // ÊÅ¢Â§çÈÄâ‰∏≠ÁöÑÂÄºÔºàÂ¶ÇÊûúËøòÂ≠òÂú®Ôºâ
        if (options.includes(currentValue)) {
          select.value = currentValue;
        }
      }
      
      // È°µÈù¢ÂàùÂßãÂåñ
      function initializePage() {
        const worldKey = getWorldFromURL();
        applyWorldTheme(worldKey);
      }
      
      // Âú®È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
      document.addEventListener('DOMContentLoaded', function() {
        initializePage();
      });
      
      // ÈÄÇÈÖçÊñ∞ÁâàÈÖçÁΩÆÊñá‰ª∂ÁöÑÂÖºÂÆπÂ±Ç
      const CHARACTER_OPTIONS_CONFIG = OPTIONS_CONFIG;
      
      // ÊÄßÂà´Êò†Â∞ÑÈÖçÁΩÆÔºàÊñ∞ÁâàÈÖçÁΩÆÊñá‰ª∂‰∏≠Ê≤°ÊúâËøô‰∏™Ôºâ
      const GENDER_MAPPING = {
        'Â•≥': 'female',
        'Êâ∂Â•π': 'all', 
        'Áî∑': 'male',
        'ÂèåÊÄß': 'all',
        'Êó†ÊÄß': 'all'
      };

      // Â∑•ÂÖ∑ÂáΩÊï∞ÔºöÊ†πÊçÆÊÄßÂà´Ëé∑ÂèñÈÄâÈ°πÔºàÈÄÇÈÖçÊñ∞ÁâàÈÖçÁΩÆÁªìÊûÑÔºâ
      function getOptionsByGender(fieldName, gender = '') {
        const config = CHARACTER_OPTIONS_CONFIG[fieldName];
        if (!config) return [];
        
        // Â¶ÇÊûú‰∏çÊòØÊÄßÂà´ÁâπÂÆöÁöÑÈÖçÁΩÆÔºåÁõ¥Êé•ËøîÂõûÈÄâÈ°π
        if (!config.genderSpecific) {
          return Array.isArray(config.options) ? config.options : [];
        }

        // Â§ÑÁêÜÊÄßÂà´ÁâπÂÆöÈÖçÁΩÆ
        const genderKey = GENDER_MAPPING[gender] || null;
        
        // Â¶ÇÊûúÊÄßÂà´‰∏∫Á©∫„ÄÅÊú™Áü•ÊàñÊò†Â∞Ñ‰∏∫'all'ÔºåÊòæÁ§∫ÊâÄÊúâÈÄâÈ°πÔºàÂêàÂπ∂ÂéªÈáçÔºâ
        if (!gender || !genderKey || genderKey === 'all') {
          const allOptions = [];
          Object.keys(config.options).forEach(key => {
            if (Array.isArray(config.options[key])) {
              allOptions.push(...config.options[key]);
            }
          });
          // ÂéªÈáçÂπ∂ËøîÂõû
          return [...new Set(allOptions)];
        }
        
        // ÂÖàÂ∞ùËØïËé∑ÂèñÊÄßÂà´ÁâπÂÆöÈÄâÈ°π
        let options = config.options[genderKey] || [];
        
        // Â¶ÇÊûúÊâæ‰∏çÂà∞ÁâπÂÆöÊÄßÂà´ÈÄâÈ°πÔºåÂ∞ùËØïËé∑ÂèñÈÄöÁî®ÈÄâÈ°π
        if (options.length === 0) {
          options = config.options.common || [];
        }
        
        // Â¶ÇÊûúËøòÊòØÁ©∫ÔºåÂêàÂπ∂ÊâÄÊúâÂèØÁî®ÈÄâÈ°πÔºàÂÖºÂÆπÊóßÁâà "all" Ê¶ÇÂøµÔºâ
        if (options.length === 0) {
          const allOptions = [];
          Object.keys(config.options).forEach(key => {
            if (Array.isArray(config.options[key])) {
              allOptions.push(...config.options[key]);
            }
          });
          // ÂéªÈáç
          options = [...new Set(allOptions)];
        }
        
        return options;
      }

      // Â∑•ÂÖ∑ÂáΩÊï∞ÔºöËé∑ÂèñÈöèÊú∫ÈÄâÈ°πÔºàÈÄÇÈÖçÊñ∞ÁâàÈÖçÁΩÆÔºâ
      function getRandomOptions(fieldName, gender = '', count = 1) {
        const config = CHARACTER_OPTIONS_CONFIG[fieldName];
        if (!config) return [];
        
        // ‰ΩøÁî®ÈÖçÁΩÆ‰∏≠ÁöÑÈöèÊú∫Êï∞ÈáèËåÉÂõ¥ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÂàô‰ΩøÁî®‰º†ÂÖ•ÁöÑcount
        let finalCount = count;
        if (config.randomCount) {
          const { min, max } = config.randomCount;
          finalCount = Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        const options = getOptionsByGender(fieldName, gender);
        if (!Array.isArray(options) || options.length === 0) return [];
        
        const shuffled = [...options].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, Math.min(finalCount, options.length));
      }

      // Â∑•ÂÖ∑ÂáΩÊï∞ÔºöÁîüÊàêÈÄâÈ°πHTMLÔºàÈÄÇÈÖçÊñ∞ÁâàÈÖçÁΩÆÔºâ
      function generateOptionsHTML(fieldName, gender = '') {
        const options = getOptionsByGender(fieldName, gender);
        if (!Array.isArray(options) || options.length === 0) return '';
        
        return options.map(option => 
          `<div class="option-btn" data-value="${option}">${option}</div>`
        ).join('\n          ');
      }

      // Â∑•ÂÖ∑ÂáΩÊï∞ÔºöÂä®ÊÄÅÊõ¥Êñ∞ÈÄâÈ°πÁΩëÊ†ºÔºàÈÄÇÈÖçÊñ∞ÁâàÈÖçÁΩÆÔºâ
      function updateOptionsGrid(fieldName, gender = '') {
        const grid = document.getElementById(fieldName + 'Grid');
        if (!grid) return;
        
        const optionsHTML = generateOptionsHTML(fieldName, gender);
        grid.innerHTML = optionsHTML;
        
        // ÈáçÊñ∞ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºàÂ¶ÇÊûúÈúÄË¶ÅÔºâ
        updateSelectedItems(fieldName);
      }

      // Á©øÊê≠È£éÊ†ºÈÄâÈ°πËé∑ÂèñÂáΩÊï∞ÔºàÊñ∞ÁâàÈÖçÁΩÆ‰∏≠Ê≤°ÊúâËøô‰∏™ÁâπÊÆäÂ§ÑÁêÜÔºâ
      function getDressStyleOptionsByGender(gender) {
        // Áî±‰∫éÊñ∞ÁâàÈÖçÁΩÆÊ≤°ÊúâdressStyleÔºåÊàë‰ª¨ÈúÄË¶Å‰ªéÁé∞ÊúâÁöÑHTML‰∏≠Ëé∑ÂèñÈÄâÈ°π
        const dressStyleSelect = document.getElementById('dressStyle');
        if (!dressStyleSelect) return [];
        
        const options = Array.from(dressStyleSelect.options)
          .map(option => option.value)
          .filter(value => value && value !== '');
        
        return options;
      }
    </script>
    <script>
      // Â≠óÊÆµÈ™åËØÅÂíåÈîôËØØÊòæÁ§∫ÂäüËÉΩ
      function showFieldError(fieldId, errorMessage) {
        const fieldGroup = document.getElementById(fieldId).closest('.form-group');
        const errorElement = document.getElementById(fieldId + 'Error');
        
        if (fieldGroup) {
          fieldGroup.classList.add('error');
        }
        
        if (errorElement) {
          if (errorMessage) {
            errorElement.textContent = errorMessage;
          }
          errorElement.style.display = 'block';
        }
        
        // ÊªöÂä®Âà∞ÈîôËØØÂ≠óÊÆµ
        document.getElementById(fieldId).scrollIntoView({ 
          behavior: 'smooth', 
          block: 'center' 
        });
      }

      function hideFieldError(fieldId) {
        const fieldGroup = document.getElementById(fieldId).closest('.form-group');
        const errorElement = document.getElementById(fieldId + 'Error');
        
        if (fieldGroup) {
          fieldGroup.classList.remove('error');
        }
        
        if (errorElement) {
          errorElement.style.display = 'none';
        }
      }

      function validateNameField() {
        const realNameInput = document.getElementById('realName');
        const realNameCustomInput = document.getElementById('realNameCustom');
        
        const realName = realNameInput.value.trim();
        const realNameCustom = realNameCustomInput.value.trim();
        
        // Ê£ÄÊü•ÊòØÂê¶Êúâ‰ªª‰ΩïÂΩ¢ÂºèÁöÑÂßìÂêçËæìÂÖ•
        if (!realName && !realNameCustom) {
          showFieldError('realName', 'ËØ∑ËæìÂÖ•ÂßìÂêçÔºåËøôÊòØÂøÖÂ°´È°π');
          return false;
        }
        
        // Ê£ÄÊü•ÂßìÂêçÈïøÂ∫¶
        const finalName = realName || realNameCustom;
        if (finalName.length > 50) {
          showFieldError('realName', 'ÂßìÂêçÈïøÂ∫¶‰∏çËÉΩË∂ÖËøá50‰∏™Â≠óÁ¨¶');
          return false;
        }
        
        hideFieldError('realName');
        return true;
      }

      // ÈÄâÈ°πÊåâÈíÆÁÇπÂáªÂäüËÉΩ
      document.querySelectorAll('.options-grid').forEach(grid => {
        grid.addEventListener('click', function (e) {
          // ÊâæÂà∞Ë¢´ÁÇπÂáªÁöÑÈÄâÈ°πÊåâÈíÆÔºàËÄÉËôëÂµåÂ•óÂÖÉÁ¥†Ôºâ
          let targetBtn = e.target;
          while (targetBtn && !targetBtn.classList.contains('option-btn')) {
            targetBtn = targetBtn.parentElement;
          }

          if (targetBtn && targetBtn.classList.contains('option-btn')) {
            // Ê£ÄÊü•ÊòØÂê¶‰∏∫ÂçïÈÄâÊ®°Âºè
            if (grid.classList.contains('single-select')) {
              // ÂçïÈÄâÊ®°ÂºèÁâπÊÆäÂ§ÑÁêÜÔºöÂ¶ÇÊûúÁÇπÂáªÂ∑≤ÈÄâ‰∏≠ÁöÑÊåâÈíÆÔºåÂàôÂèñÊ∂àÈÄâÊã©
              if (targetBtn.classList.contains('selected')) {
                targetBtn.classList.remove('selected');
                targetBtn.removeAttribute('data-user-selected');

                // ÁâπÊÆäÂ§ÑÁêÜÁªëÂÆöÁ≥ªÁªüÁöÑÂéüÂõ†ÔºåÈáçÁΩÆË¥¶Êà∑‰ΩôÈ¢ù
                if (grid.id === 'systemReasonGrid') {
                  updateAccountBalance(0);
                }
              } else {
                // Ê∏ÖÈô§ÂÖ∂‰ªñÈÄâÊã©ÔºåÂè™ÈÄâ‰∏≠ÂΩìÂâçÈ°π
                grid.querySelectorAll('.option-btn').forEach(btn => {
                  btn.classList.remove('selected');
                  btn.removeAttribute('data-user-selected');
                });
                targetBtn.classList.add('selected');
                targetBtn.setAttribute('data-user-selected', 'true');

                // ÁâπÊÆäÂ§ÑÁêÜÁªëÂÆöÁ≥ªÁªüÁöÑÂéüÂõ†ÔºåÊõ¥Êñ∞Ë¥¶Êà∑‰ΩôÈ¢ù
                if (grid.id === 'systemReasonGrid') {
                  const balance = targetBtn.getAttribute('data-balance');
                  if (balance !== null) {
                    updateAccountBalance(parseInt(balance));
                  }
                }
              }
            } else {
              // Â§öÈÄâÊ®°ÂºèÔºöÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
              if (targetBtn.classList.contains('selected')) {
                targetBtn.classList.remove('selected');
                targetBtn.removeAttribute('data-user-selected');
              } else {
                targetBtn.classList.add('selected');
                targetBtn.setAttribute('data-user-selected', 'true');
              }
            }
            updateSelectedItems(grid.id.replace('Grid', ''));
          }
        });
      });

      // ÊäòÂè†ÂäüËÉΩ
      function toggleCollapse(sectionName) {
        const header = document.querySelector(`#${sectionName}Section .collapsible-header`);
        const content = document.querySelector(`#${sectionName}Content`);
        const selectedItems = document.querySelector(`#${sectionName}Selected`);

        header.classList.toggle('collapsed');
        content.classList.toggle('collapsed');

        // Â¶ÇÊûúÊäòÂè†‰∏îÊúâÈÄâ‰∏≠È°πÔºåÊòæÁ§∫ÈÄâ‰∏≠È°π
        if (header.classList.contains('collapsed') && selectedItems.children.length > 0) {
          selectedItems.classList.add('show');
        } else {
          selectedItems.classList.remove('show');
        }
      }

      // Êõ¥Êñ∞ÈÄâ‰∏≠È°πÊòæÁ§∫
      function updateSelectedItems(sectionName) {
        const grid = document.getElementById(sectionName + 'Grid');
        const selectedContainer = document.getElementById(sectionName + 'Selected');

        if (!grid || !selectedContainer) return;

        const selectedBtns = grid.querySelectorAll('.option-btn.selected');
        const customInput = document.getElementById(sectionName + 'Custom');
        selectedContainer.innerHTML = '';

        // ÊòæÁ§∫ÈÄâ‰∏≠ÁöÑÈÄâÈ°π
        selectedBtns.forEach(btn => {
          const item = document.createElement('div');
          item.className = 'selected-item';

          // ÁâπÊÆäÂ§ÑÁêÜÁ≥ªÁªüÂéüÂõ†ÈÄâÈ°πÔºåÊòæÁ§∫Ê†áÈ¢òËÄå‰∏çÊòØdata-value
          if (sectionName === 'systemReason' && btn.classList.contains('system-reason-option')) {
            const titleElement = btn.querySelector('.system-reason-title');
            item.textContent = titleElement ? titleElement.textContent : btn.getAttribute('data-value');
          } else {
            item.textContent = btn.getAttribute('data-value');
          }

          selectedContainer.appendChild(item);
        });

        // ÊòæÁ§∫Ëá™ÂÆö‰πâËæìÂÖ•ÁöÑÂÜÖÂÆπ
        if (customInput && customInput.value.trim()) {
          const customItems = customInput.value
            .split(',')
            .map(s => s.trim())
            .filter(s => s);
          customItems.forEach(customValue => {
            const item = document.createElement('div');
            item.className = 'selected-item';
            item.style.backgroundColor = 'var(--accent-color)'; // Âº∫Ë∞ÉËâ≤ËÉåÊôØÂå∫ÂàÜËá™ÂÆö‰πâËæìÂÖ•
            item.textContent = customValue;
            selectedContainer.appendChild(item);
          });
        }

        // Êõ¥Êñ∞ÊäòÂè†Áä∂ÊÄÅÊòæÁ§∫
        const header = document.querySelector(`#${sectionName}Section .collapsible-header`);
        if (header && header.classList.contains('collapsed')) {
          const hasSelectedItems = selectedBtns.length > 0 || (customInput && customInput.value.trim());
          if (hasSelectedItems) {
            selectedContainer.classList.add('show');
          } else {
            selectedContainer.classList.remove('show');
          }
        }
      }

      // Ëé∑ÂèñÂΩìÂâçÊÄßÂà´
      function getCurrentGender() {
        const biologicalGender = document.getElementById('biologicalGender').value;
        return biologicalGender;
      }

      // Ê†πÊçÆÊÄßÂà´Ëé∑ÂèñÈù¢Ë≤åÈÄâÈ°πËåÉÂõ¥Ôºà‰ΩøÁî®ÈÖçÁΩÆÔºâ
      // Ê£ÄÊü•Â≠óÊÆµÊòØÂê¶Â∑≤ÊúâÁî®Êà∑‰∏ªÂä®ÈÄâÊã©ÁöÑÂÄº
      function hasUserValue(fieldName) {
        const element = document.getElementById(fieldName);
        if (element) {
          if (
            element.type === 'number' ||
            element.tagName === 'INPUT' ||
            element.tagName === 'SELECT' ||
            element.tagName === 'TEXTAREA'
          ) {
            return element.value && element.value.trim() !== '' && element.dataset.userSelected === 'true';
          }
        }

        // Ê£ÄÊü•Â§öÈÄâÈÄâÈ°π
        const grid = document.getElementById(fieldName + 'Grid');
        if (grid) {
          const userSelectedBtns = grid.querySelectorAll('.option-btn.selected[data-user-selected="true"]');
          if (userSelectedBtns.length > 0) return true;
        }

        // Ê£ÄÊü•Ëá™ÂÆö‰πâËæìÂÖ•
        const customInput = document.getElementById(fieldName + 'Custom');
        if (
          customInput &&
          customInput.value &&
          customInput.value.trim() !== '' &&
          customInput.dataset.userSelected === 'true'
        ) {
          return true;
        }

        return false;
      }

      // Ê£ÄÊü•Â≠óÊÆµÊòØÂê¶Â∑≤ÊúâÂÄºÔºà‰∏çÂå∫ÂàÜÁî®Êà∑ÈÄâÊã©ËøòÊòØÈöèÊú∫ÁîüÊàêÔºâ
      function hasValue(fieldName) {
        const element = document.getElementById(fieldName);
        if (element) {
          if (
            element.type === 'number' ||
            element.tagName === 'INPUT' ||
            element.tagName === 'SELECT' ||
            element.tagName === 'TEXTAREA'
          ) {
            return element.value && element.value.trim() !== '';
          }
        }

        // Ê£ÄÊü•Â§öÈÄâÈÄâÈ°π
        const grid = document.getElementById(fieldName + 'Grid');
        if (grid) {
          const selectedBtns = grid.querySelectorAll('.option-btn.selected');
          if (selectedBtns.length > 0) return true;
        }

        // Ê£ÄÊü•Ëá™ÂÆö‰πâËæìÂÖ•
        const customInput = document.getElementById(fieldName + 'Custom');
        if (customInput && customInput.value && customInput.value.trim() !== '') {
          return true;
        }

        return false;
      }

      // ÈöèÊú∫ÂåñÂ≠óÊÆµÂäüËÉΩ
      function randomizeField(fieldName, force = false) {
        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Ê®°Âºè‰∏îÊúâÁî®Êà∑‰∏ªÂä®ÈÄâÊã©ÁöÑÂÄºÔºåÂàôË∑≥Ëøá
        if (!force && hasUserValue(fieldName)) {
          return;
        }

        const randomData = {
          age: () => Math.floor(Math.random() * 18) + 18, // 18-35Â≤Å
          biologicalGender: () => ['Â•≥', 'Áî∑', 'Êâ∂Â•π', 'ÂèåÊÄß', 'Êó†ÊÄß'][Math.floor(Math.random() * 5)],
          sexualOrientation: () =>
            ['ÂºÇÊÄßÊÅã', 'ÂêåÊÄßÊÅã', 'ÂõõÁà±', 'ÂèåÊÄßÊÅã', 'Ê≥õÊÄßÊÅã', 'Êó†Áà±ËÄÖ', 'Êó†ÊÄßÊÅã'][Math.floor(Math.random() * 7)],
          positiveTraits: () => getRandomOptions('positiveTraits', getCurrentGender(), Math.floor(Math.random() * 3) + 1),
          negativeTraits: () => getRandomOptions('negativeTraits', getCurrentGender(), Math.floor(Math.random() * 3) + 1),
          loveViews: () => getRandomOptions('loveViews', getCurrentGender(), Math.floor(Math.random() * 3) + 1),
          socialStyle: () => getRandomOptions('socialStyle', getCurrentGender(), Math.floor(Math.random() * 3) + 1),
          face: () => getRandomOptions('face', getCurrentGender(), Math.floor(Math.random() * 2) + 1),
          body: () => getRandomOptions('body', getCurrentGender(), Math.floor(Math.random() * 2) + 1),
          skinColor: () =>
            ['ÂÜ∑ÁôΩ', 'ÊöñÁôΩ', 'ÂÅèÈªÑ', 'Â∞èÈ∫¶Ëâ≤', 'ËúúÁ≥ñËâ≤', 'Ê∑±Ê£ïËâ≤', 'ÈÄèÊòéÊÑüÁôΩ', 'ÁóÖÊÄÅËãçÁôΩ', 'ÈªëÁöÆ'][
              Math.floor(Math.random() * 9)
            ],
          eyeColor: () =>
            [
              'ÈªëËâ≤',
              'ÁôΩËâ≤',
              'Ê£ïËâ≤',
              'ÁÅ∞Ëâ≤',
              'ÈÖíÁ∫¢Ëâ≤',
              '‰∫ÆÁ∫¢Ëâ≤',
              'Á¥´Ëâ≤',
              'ËìùËâ≤',
              'ÁªøËâ≤',
              'Èì∂Ëâ≤',
              'ÁÉüÁ¥´Ëâ≤',
              'ÊµÖÁ¥´',
              'ÊµÖÁ≤âËâ≤',
              'Áé´Áë∞Ëâ≤',
              'ÈõæËìùÁÅ∞',
              'ÊµÖÊµ∑Ëìù',
              'Â¢®ÁªøËâ≤',
              'ÁÅ∞ÁªøËâ≤',
              'ÁÅ∞ËìùËâ≤',
              'Â§©ËìùËâ≤',
            ][Math.floor(Math.random() * 20)],
          facialFeatures: () =>
            [
              'Âá§Áúº',
              'ÂúÜÁúº',
              'Ê°ÉËä±Áúº',
              'ÂçïÁúºÁöÆ',
              'ÂÜÖÂèå',
              'ÁãóÁãó‰∏ãÂûÇÁúº',
              'ÈïøÁù´ÊØõ',
              'ÂæÆÁ¨ëÂîá',
              'ËñÑÂîá',
              'ÂéöÂîá',
              'Â∞èÁøòÈºª',
              'È´òÈºªÊ¢Å',
              'Áæé‰∫∫Áó£',
              'Ê≥™Áó£',
              'ÁúâÂøÉÁó£',
              'ÈÖíÁ™ù',
              'Ê¢®Ê∂°',
              'ÈõÄÊñë',
              'Áæé‰∫∫Â∞ñ',
              'Â©¥ÂÑøËÇ•',
              'ÁúâÊØõÊúâÁñ§',
            ][Math.floor(Math.random() * 21)],
          hairColor: () =>
            [
              'ÈªëËâ≤',
              'ÁôΩËâ≤',
              'Ê£ïËâ≤',
              'Áé´Áë∞Èáë',
              'ÈÖíÁ∫¢Ëâ≤',
              '‰∫ÆÁ∫¢Ëâ≤',
              'Á¥´Ëâ≤',
              'ËìùËâ≤',
              'ÁªøËâ≤',
              'Â•∂Â•∂ÁÅ∞',
              'Èì∂Ëâ≤',
              'Ê∑±ÁÅ∞Ëâ≤',
              'ÁÉüÁÅ∞Ëâ≤',
              'ÊµÖÁ¥´',
              'ÊµÖÁ≤âËâ≤',
              'Áé´Áë∞Ëâ≤',
              'ÈõæËìùÁÅ∞',
              'ÊµÖÊµ∑Ëìù',
              'Ê∏êÂèòËâ≤',
              'ÊåëÊüì',
              'ÊåÇËÄ≥Êüì',
              'ÂèëÂ∞æÊüì',
            ][Math.floor(Math.random() * 22)],
          hairStyle: () =>
            [
              'Áü≠Âèë',
              '‰∏≠ÈïøÂèë',
              'ÈïøÂèë',
              'ÂèäËÇ©ÈïøÂèë',
              'ÂèäËÖ∞ÈïøÂèë',
              'Áõ¥Âèë',
              'Âç∑Âèë',
              'ÊùøÂØ∏',
              'ÂâçÂà∫',
              'ÂæÆÂàÜÁ¢éÁõñ',
              'ËÉåÂ§¥',
              '‰∏≠ÂàÜ',
              'ÁãºÂ∞æÂèëÂûã',
              'ÂçäÊâéÂèë',
              'È´òÈ©¨Â∞æ',
              '‰ΩéÈ©¨Â∞æ',
              '‰∏∏Â≠êÂ§¥',
              'ÈïøÁõ¥Âèë',
              'Â§ßÊ≥¢Êµ™ÈïøÂèë',
              'ÂèåÈ©¨Â∞æ',
              'Âçï‰æßÁºñÂèë',
            ][Math.floor(Math.random() * 21)],
          dressStyle: () => {
            const gender = getCurrentGender();
            const styles = getDressStyleOptionsByGender(gender);
            return styles[Math.floor(Math.random() * styles.length)];
          },
          accessories: () => {
            const accessories = [
              'Ê°ÜÊû∂ÁúºÈïú',
              'ÈáëÂ±ûÁªÜÊ°ÜÁúºÈïú',
              'ËÄ≥ÁéØ',
              'ÈïøËÄ≥Âù†',
              'ËÄ≥Èíâ',
              'È°πÈìæ',
              'ÈáëÂ±ûÈìæÊù°',
              'ÊâãË°®',
              'ÊàíÊåá',
              'Èì∂ÊàíÊåá',
              'ÊâãÈìæ',
              'ÊâãÈïØ',
              'ÂîáÈíâ',
              'ÁúâÈíâ',
              '‰π≥Èíâ',
              'ËàåÈíâ',
              'È¢ÜÂ∏¶',
              'ËÉ∏Èíà',
              'Ë¢ñÊâ£',
              'Ê£íÁêÉÂ∏Ω',
              'Ê∏îÂ§´Â∏Ω',
              'Âè£ÁΩ©',
            ];
            return accessories[Math.floor(Math.random() * accessories.length)];
          },
          illness: () => {
            const illnesses = [
              'ËÉÉÁóÖ',
              'ÂÅèÂ§¥Áóõ',
              'Â§±Áú†Áóá',
              'ÊäëÈÉÅÁóá',
              'ÁÑ¶ËôëÁóá',
              'Ë∫ÅÈÉÅÁóá',
              'PTSD',
              'ÊñØÂæ∑Âì•Â∞îÊë©ÁªºÂêàÂæÅ',
              'ADHD',
              'Á§æ‰∫§ÊÅêÊÉßÁóá',
              'ÂπΩÈó≠ÊÅêÊÉßÁóá',
              'ÂìÆÂñò',
              'ÂøÉËÑèÁóÖ',
              'ËøáÊïè‰ΩìË¥®',
              'ÂéåÈ£üÁóá',
              'Êö¥È£üÁóá',
              'Âº∫Ëø´Áóá',
              'Ê¥ÅÁôñ',
              'ÊÅêÈ´ò',
              'ËÑ∏Áõ≤',
              'ÈÄâÊã©Âõ∞ÈöæÁóá',
              '‰∫∫Ê†ºÂàÜË£Ç',
              'ÊÉÖÊÑüÈöîÁ¶ª',
              'ÈáçÂ∫¶ËßÜÂäõÈöúÁ¢ç',
              'ÁúºÁõ≤',
              'ËÄ≥ËÅã',
              'ÂìëÂ∑¥',
              '‰∏ãËÇ¢Áò´Áó™',
              'ÂãÉËµ∑ÈöúÁ¢ç',
              'Êó†Ê≥ïÂ∞ÑÁ≤æ',
              'ÊÄßÁòæ',
            ];
            return illnesses[Math.floor(Math.random() * illnesses.length)];
          },
          characterTrait: () => {
            const traits = [
              'Êé®ÁúºÈïú',
              'ÊÄùËÄÉÊó∂‰ºöËΩªÂí¨‰∏ãÂîá',
              '‰∏é‰∫∫‰∫§Ë∞àÊó∂Ë∫´‰Ωì‰ºöÂæÆÂæÆÂâçÂÄæ',
              'ÊääÁé©Áâ©ÂìÅ',
              'ÊåâÂ§™Èò≥Á©¥',
              'ÊâãÊèíÂÖú',
              'Âè£Â§¥Á¶Ö',
              'Êää"Ë∞¢Ë∞¢"ÊåÇÂú®Âò¥Ëæπ',
              'ÂñúÊ¨¢ËØ¥Âè†ËØç',
              'Ê∏ØÂè∞ËÖî',
              'Âåó‰∫¨ËÖî',
              '‰∏úÂåóËØù',
              'Á≤§ËØ≠',
              'ËØ¥ËØùÊó∂ÂñúÊ¨¢ÈÖç‰∏äËÇ¢‰ΩìÊé•Ëß¶',
            ];
            return traits[Math.floor(Math.random() * traits.length)];
          },
          bodyScent: () => {
            const scents = [
              'Êó†ÁâπÊÆäÊ∞îÂë≥',
              'Ê∏ÖÊ∑°ÁöÑÁöÇÈ¶ô',
              'Ê∏ÖÁàΩÁöÑÊ¥óË°£Ê∂≤Âë≥',
              'Èò≥ÂÖâÊôíËøáÁöÑÂë≥ÈÅì',
              'ÁâõÂ•∂Âë≥',
              'Â•∂Á≥ñÂë≥',
              'Ê∑°Ê∑°ÁöÑËä±È¶ôÂë≥',
              'Èõ®ÂêéÊ£ÆÊûóÁöÑÊ∞îÊÅØ',
              'Â∏∏Áî®ÁöÑÈ¶ôÊ∞¥Âë≥',
              'Êú®Ë¥®È¶ô',
              'Êµ∑Ê¥ãË∞ÉÈ¶ô',
              'ÊüëÊ©òÈ¶ô',
              'Ëç∑Â∞îËíôÊ∞îÊÅØÂº∫ÁÉà',
              'Ê±óÂë≥',
              'ÁÉüËçâÂë≥',
              'ÂíñÂï°È¶ô',
              'Ëå∂È¶ô',
              'Ê∂àÊØíÊ∞¥Âë≥',
              '‰π¶Â¢®Âë≥',
              'ÂÜ∑ÂÜΩÁöÑÁ©∫Ê∞îÂë≥',
              'ÁîúËÖªÁöÑÁ≥ïÁÇπÂë≥',
              'ÂæÆÂº±ÁöÑË°ÄËÖ•Âë≥',
            ];
            return scents[Math.floor(Math.random() * scents.length)];
          },
          sensitivity: () => {
            const levels = [
              'Ë∫´‰ΩìËøüÈíù',
              'ÊôÆÈÄöÊïèÊÑü',
              'ËæÉ‰∏∫ÊïèÊÑü',
              'ÂæàÊïèÊÑü',
              'ÂÖ®Ë∫´ÈÉΩÊòØÊïèÊÑüÁÇπ',
              'ËΩªËß¶Âç≥ÂèØÂî§Ëµ∑Âø´ÊÑü',
              'ÁóõÊÑü‰∏éÂø´ÊÑüÁïåÈôêÊ®°Á≥ä',
              'Ëß¶Á¢∞Â∞±È´òÊΩÆ',
              'Â§öÈáçÈ´òÊΩÆ‰ΩìË¥®',
              'ÊÑüËßâËøáËΩΩ(ÊòìË¢´ËøáÂ∫¶Âà∫ÊøÄ)',
            ];
            return levels[Math.floor(Math.random() * levels.length)];
          },
          sexualHistory: () => {
            const histories = [
              'Êó†ÊÄßÁªèÈ™å',
              '‰ªÖÊúâÁêÜËÆ∫Áü•ËØÜ',
              '‰ªÖÊúâ‰∏ÄÊ¨°ÁªèÈ™å',
              'ÁªèÈ™åÂæàÂ∞ë',
              'Âè™ÊúâÂõ∫ÂÆöÁöÑÈïøÊúü‰º¥‰æ£',
              'ÁªèÈ™åÈÄÇ‰∏≠',
              'ÊúâËøáÊï∞‰Ωç‰º¥‰æ£',
              'ÁªèÈ™å‰∏∞ÂØå',
              'ÊÄßËßÇÂøµÂºÄÊîæ',
              'ÊÄßÂÖ≥Á≥ªÊ∑∑‰π±',
              'ÊúâBDSMÁªèÈ™å',
              '‰ªÖÊúâÂêåÊÄßÁªèÈ™å',
              '‰ªÖÊúâÂºÇÊÄßÁªèÈ™å',
              'ÂèåÊÄßÁªèÈ™åÁöÜÊúâ',
              'ÊúâËøáÈùûËá™ÊÑøÊÄßË°å‰∏∫',
              'ÊõæÂ´ñÂ®º',
              'ÂΩìËøáÂ®º',
              'Êúâ‰∏∫‰∫ÜËµÑÊ∫êÊàñÁõÆÁöÑÁöÑÊÄßÁªèÂéÜ',
              'ÊõæÊúâÁªèÈ™å‰ΩÜÂæà‰πÖÊ≤°ÊúâÊÄßÁîüÊ¥ª',
            ];
            return histories[Math.floor(Math.random() * histories.length)];
          },
          libido: () => {
            const levels = [
              'Á¶ÅÊ¨≤',
              'Êó†ÊÄßÊ¨≤',
              'ÊûÅ‰ΩéÊÄßÊ¨≤',
              '‰Ωé‰∫éÊôÆÈÄö',
              'ÊôÆÈÄöÊÄßÊ¨≤',
              'È´ò‰∫éÂπ≥Âùá',
              'Âº∫ÁÉàÊÄßÊ¨≤',
              'ÊûÅÈ´òÊÄßÊ¨≤',
              'Êó∂Êó∂ÂàªÂàªÈÉΩÊúâÊûÅÈ´òÊÄßÊ¨≤',
            ];
            return levels[Math.floor(Math.random() * levels.length)];
          },
          kinks: () => getRandomOptions('kinks', getCurrentGender(), Math.floor(Math.random() * 5) + 1),
          hobbies: () => getRandomOptions('hobbies', getCurrentGender(), Math.floor(Math.random() * 4) + 2),
          sensitiveSpots: () => getRandomOptions('sensitiveSpots', getCurrentGender(), Math.floor(Math.random() * 3) + 2),
        };

        if (randomData[fieldName]) {
          const value = randomData[fieldName]();

          if (Array.isArray(value)) {
            // Â§ÑÁêÜÂ§öÈÄâÈÄâÈ°π
            const grid = document.getElementById(fieldName + 'Grid');
            if (grid) {
              // Ê∏ÖÈô§ÊâÄÊúâÈÄâÊã©
              grid.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
              // ÈÄâÊã©ÈöèÊú∫È°π
              value.forEach(item => {
                const btn = grid.querySelector(`[data-value="${item}"]`);
                if (btn) btn.classList.add('selected');
              });
              // Êõ¥Êñ∞ÈÄâ‰∏≠È°πÊòæÁ§∫
              updateSelectedItems(fieldName);
            }
          } else {
            // Â§ÑÁêÜÂçïÈÄâÈ°πÂíåÊï∞ÂÄºÈ°π
            const element = document.getElementById(fieldName);
            if (element) {
              element.value = value;
            }
          }
        }

        // ÁâπÊÆäÂ§ÑÁêÜË∫´È´ò‰ΩìÈáçÁöÑÈöèÊú∫ÂÄº
        if (fieldName === 'age') {
          const ageElement = document.getElementById('age');
          if (ageElement) {
            ageElement.value = Math.floor(Math.random() * 18) + 18; // 18-35Â≤Å
          }
        } else if (fieldName === 'height') {
          const heightElement = document.getElementById('height');
          const gender = getCurrentGender();
          if (heightElement) {
            if (gender === 'Â•≥' || gender === 'Êâ∂Â•π') {
              heightElement.value = Math.floor(Math.random() * 41) + 140; // 140-180cm
            } else if (gender === 'Áî∑' || gender === 'ÂèåÊÄß') {
              heightElement.value = Math.floor(Math.random() * 24) + 175; // 175-198cm
            } else {
              heightElement.value = Math.floor(Math.random() * 59) + 140; // 140-198cm
            }
          }
        } else if (fieldName === 'weight') {
          const weightElement = document.getElementById('weight');
          const gender = getCurrentGender();
          if (weightElement) {
            if (gender === 'Â•≥' || gender === 'Êâ∂Â•π') {
              weightElement.value = Math.floor(Math.random() * 21) + 40; // 40-60kg
            } else if (gender === 'Áî∑' || gender === 'ÂèåÊÄß') {
              weightElement.value = Math.floor(Math.random() * 21) + 60; // 60-80kg
            } else {
              weightElement.value = Math.floor(Math.random() * 41) + 40; // 40-80kg
            }
          }
        }
      }

      // Ëé∑ÂèñÈöèÊú∫È°πÁõÆ
      function getRandomItems(array, count) {
        const shuffled = array.sort(() => 0.5 - Math.random());
        return shuffled.slice(0, count);
      }

      // Â±ûÊÄßÂä†ÁÇπÂäüËÉΩ
      function updateAttributeInput(attributeName, value) {
        const input = document.getElementById(attributeName + 'Input');
        if (input) {
          input.value = value;
        }
      }

      function updateAttributeSlider(attributeName, value) {
        const slider = document.getElementById(attributeName + 'Slider');
        if (slider) {
          slider.value = Math.max(0, Math.min(100, parseInt(value) || 0));
        }
      }

      function randomizeAttribute(attributeName, force = false) {
        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Ê®°Âºè‰∏îÊúâÁî®Êà∑‰∏ªÂä®ÈÄâÊã©ÁöÑÂÄºÔºåÂàôË∑≥Ëøá
        if (!force) {
          const input = document.getElementById(attributeName + 'Input');
          if (
            input &&
            input.value &&
            input.value !== '10' &&
            input.value !== '0' &&
            input.dataset.userSelected === 'true'
          ) {
            return;
          }
        }

        let randomValue;
        if (attributeName === 'reputation') {
          // È£éËØÑÂÄºÁöÑÈöèÊú∫ËåÉÂõ¥ÊòØ-80Âà∞+80
          randomValue = Math.floor(Math.random() * 161) - 80; // -80 Âà∞ +80
        } else {
          // ÂÖ∂‰ªñÂ±ûÊÄßÁöÑÈöèÊú∫ËåÉÂõ¥ÊòØ0-100
          randomValue = Math.floor(Math.random() * 101); // 0-100ËåÉÂõ¥
        }

        const slider = document.getElementById(attributeName + 'Slider');
        const input = document.getElementById(attributeName + 'Input');

        if (slider) slider.value = randomValue;
        if (input) input.value = randomValue;
      }

      function randomizeAllAttributes() {
        // Â±ûÊÄßÂä†ÁÇπÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§
        alert('Â±ûÊÄßÂä†ÁÇπÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§');
      }

      function randomizeBasicAttributes() {
        // Âü∫Á°ÄÂ±ûÊÄßÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§
        alert('Âü∫Á°ÄÂ±ûÊÄßÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§');
      }

      function randomizeAbilityAttributes() {
        // ËÉΩÂäõÊï∞ÂÄºÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§
        alert('ËÉΩÂäõÊï∞ÂÄºÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§');
      }

      // Ë¥¶Êà∑‰ΩôÈ¢ùÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§
      function updateAccountBalance(balance) {
        // ÂäüËÉΩÂ∑≤Ë¢´ÁßªÈô§
      }

      // ÁªèÂéÜÈÉ®ÂàÜÁöÑÈöèÊú∫Âåñ
      function randomizeExperienceField(fieldName, force = false) {
        // Â¶ÇÊûú‰∏çÊòØÂº∫Âà∂Ê®°Âºè‰∏îÊúâÁî®Êà∑‰∏ªÂä®ÈÄâÊã©ÁöÑÂÄºÔºåÂàôË∑≥Ëøá
        if (!force && hasUserValue(fieldName)) {
          return;
        }
        const experienceData = {
          identity: () => getRandomOptions('identity', getCurrentGender(), 1)[0],

          relationshipStatus: () => getRandomOptions('relationshipStatus', getCurrentGender(), 1)[0],
        };

        const value = experienceData[fieldName]();
        const grid = document.getElementById(fieldName + 'Grid');

        if (grid) {
          // Ê∏ÖÈô§ÊâÄÊúâÈÄâÊã©
          grid.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));

          if (fieldName === 'systemReason') {
            // ÁâπÊÆäÂ§ÑÁêÜÁªëÂÆöÁ≥ªÁªüÁöÑÂéüÂõ†
            const btn = grid.querySelector(`[data-value="${value.value}"]`);
            if (btn) {
              btn.classList.add('selected');
              updateAccountBalance(value.balance);
            }
          } else {
            // ÈÄâÊã©ÈöèÊú∫È°π
            const btn = grid.querySelector(`[data-value="${value}"]`);
            if (btn) btn.classList.add('selected');
          }

          // Êõ¥Êñ∞ÈÄâ‰∏≠È°πÊòæÁ§∫
          updateSelectedItems(fieldName);
        }
      }

      // ÈöèÊú∫ÁîüÊàêÊâÄÊúâÁªèÂéÜ
      function randomizeAllExperience() {
        randomizeExperienceField('identity');
        randomizeExperienceField('relationshipStatus');

        alert('Â∑≤ÈöèÊú∫ÁîüÊàêÊâÄÊúâÁªèÂéÜ‰ø°ÊÅØÔºÅ');
      }

      // ÁºñËæëËá™ÂÆö‰πâËæìÂÖ•
      function editCustom(fieldName) {
        const customInput = document.getElementById(fieldName + 'Custom');
        if (customInput) {
          customInput.classList.toggle('show');
          if (customInput.classList.contains('show')) {
            customInput.focus();
          }
        }
      }

      // ‰∏∫ÊâÄÊúâËá™ÂÆö‰πâËæìÂÖ•Ê°ÜÂíåÊôÆÈÄöËæìÂÖ•Ê°ÜÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
      function setupCustomInputListeners() {
        const customInputs = document.querySelectorAll('[id$="Custom"]');
        customInputs.forEach(input => {
          input.addEventListener('input', function () {
            const fieldName = this.id.replace('Custom', '');
            // Ê†áËÆ∞‰∏∫Áî®Êà∑ÈÄâÊã©
            this.setAttribute('data-user-selected', 'true');
            updateSelectedItems(fieldName);
            
            // Â¶ÇÊûúÊòØÂßìÂêçÂ≠óÊÆµÔºåËøõË°åÂÆûÊó∂È™åËØÅ
            if (fieldName === 'realName') {
              validateNameField();
            }
          });
        });

        // ‰∏∫ÊôÆÈÄöËæìÂÖ•Ê°ÜÊ∑ªÂä†Áî®Êà∑ÈÄâÊã©Ê†áËÆ∞
        const normalInputs = document.querySelectorAll('input, select, textarea');
        normalInputs.forEach(input => {
          if (!input.id.endsWith('Custom')) {
            input.addEventListener('input', function () {
              this.setAttribute('data-user-selected', 'true');
              
              // Â¶ÇÊûúÊòØÂßìÂêçÂ≠óÊÆµÔºåËøõË°åÂÆûÊó∂È™åËØÅ
              if (this.id === 'realName') {
                validateNameField();
              }
            });
            input.addEventListener('change', function () {
              this.setAttribute('data-user-selected', 'true');
              
              // Â¶ÇÊûúÊòØÂßìÂêçÂ≠óÊÆµÔºåËøõË°åÂÆûÊó∂È™åËØÅ
              if (this.id === 'realName') {
                validateNameField();
              }
            });
          }
        });
      }

      // ÈöèÊú∫ÁîüÊàêÂÖ®ÈÉ®
      function randomizeAll() {
        if (confirm('Á°ÆÂÆöË¶ÅÈöèÊú∫ÁîüÊàêÂÖ®ÈÉ®‰ø°ÊÅØÂêóÔºüËøôÂ∞ÜÂè™Â°´ÂÖÖÁ©∫ÁôΩÈÉ®ÂàÜÔºå‰∏ç‰ºöË¶ÜÁõñÂ∑≤Â°´ÂÜôÁöÑÂÜÖÂÆπ„ÄÇ')) {
          // ÂÖàÈöèÊú∫ÁîüÁêÜÊÄßÂà´ÔºåÂõ†‰∏∫ÂÖ∂‰ªñÈÄâÈ°π‰ºöÊ†πÊçÆÊÄßÂà´ËøõË°åÁ≠õÈÄâ
          randomizeField('biologicalGender');

          // Âü∫Êú¨‰ø°ÊÅØ
          randomizeField('age');
          randomizeField('sexualOrientation');

          // ÊÄßÊ†ºÁâπÂæÅ
          randomizeField('positiveTraits');
          randomizeField('negativeTraits');
          randomizeField('loveViews');
          randomizeField('socialStyle');

          // Â§ñË≤åËÆæÂÆöÔºàËøô‰∫õ‰ºöÂèóÊÄßÂà´ÂΩ±ÂìçÔºâ
          randomizeField('height');
          randomizeField('weight');
          randomizeField('face');
          randomizeField('body');
          randomizeField('dressStyle');

          // ÂÖ∂‰ªñÂ§ñË≤åËÆæÂÆöÔºà‰∏çÂèóÊÄßÂà´ÂΩ±ÂìçÔºâ
          randomizeField('skinColor');
          randomizeField('eyeColor');
          randomizeField('facialFeatures');
          randomizeField('hairColor');
          randomizeField('hairStyle');
          randomizeField('accessories');

          // ÂÖ∂‰ªñËÆæÂÆö
          randomizeField('illness');
          randomizeField('characterTrait');
          randomizeField('bodyScent');
          randomizeField('sensitivity');
          randomizeField('sexualHistory');
          randomizeField('libido');
          randomizeField('kinks');
          randomizeField('hobbies');
          randomizeField('sensitiveSpots');

          // ÈöèÊú∫ÂåñÁªèÂéÜ
          randomizeExperienceField('identity');
          randomizeExperienceField('relationshipStatus');

          alert('Â∑≤ÈöèÊú∫ÁîüÊàêÊâÄÊúâ‰ø°ÊÅØÔºÅ');
        }
      }

      // ÊòæÁ§∫ËØ¥ÊòéÈ°µÈù¢
      function showInstructionPage() {
        // ÈöêËóèÂéüÂßãË°®ÂçïÈ°µÈù¢
        const mainPanel = document.querySelector('.main-panel:not(.instruction-panel)');
        if (mainPanel) {
          mainPanel.style.display = 'none';
        }

        // ÊòæÁ§∫ËØ¥ÊòéÈ°µÈù¢
        const instructionPanel = document.getElementById('instructionPanel');
        if (instructionPanel) {
          instructionPanel.style.display = 'flex';

          // Ê∑ªÂä†Ê∑°ÂÖ•Âä®ÁîªÊïàÊûú
          instructionPanel.style.opacity = '0';
          instructionPanel.style.transition = 'opacity 0.8s ease-in-out';

          setTimeout(() => {
            instructionPanel.style.opacity = '1';
          }, 100);
        }
      }

      // Á°ÆËÆ§ÂàõÂª∫ËßíËâ≤
      function confirmCreate() {
        
        // ÂÖàËøõË°åË°®ÂçïÈ™åËØÅ
        if (!validateNameField()) {
          return;
        }
        
        const characterData = collectFormData();

        // Ëé∑ÂèñÊúÄÁªàÁöÑÂßìÂêçÔºà‰ºòÂÖà‰ΩøÁî®Â∏∏ËßÑËæìÂÖ•ÔºåÁÑ∂ÂêéÊòØËá™ÂÆö‰πâËæìÂÖ•Ôºâ
        const finalName = characterData.realName || 
                         document.getElementById('realNameCustom').value.trim();

        if (!finalName) {
          showFieldError('realName', 'ËØ∑ËæìÂÖ•ÂßìÂêçÔºåËøôÊòØÂøÖÂ°´È°π');
          alert('ËØ∑ÂÖàÂ°´ÂÜôÂøÖÂ°´È°πÁõÆÔºÅ');
          return;
        }

        const confirmMsg = `Á°ÆËÆ§ÁîüÊàêËßíËâ≤Ôºö${finalName}Ôºü`;

        if (confirm(confirmMsg)) {

          try {
            // ÊòæÁ§∫YAMLÊï∞ÊçÆ
            showYamlModal(characterData);
            
            alert('ËßíËâ≤Êï∞ÊçÆÁîüÊàêÊàêÂäüÔºÅËØ∑Êü•ÁúãYAMLËæìÂá∫Á™óÂè£„ÄÇ');

          } catch (error) {
            alert('ÁîüÊàêËßíËâ≤Êï∞ÊçÆÊó∂ÂèëÁîüÈîôËØØÔºåËØ∑Ê£ÄÊü•ÊéßÂà∂Âè∞Ëé∑ÂèñËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ');
          }
        }
      }

      // ÂàõÂª∫ InitVar ‰∏ñÁïå‰π¶Êù°ÁõÆ
      async function createInitVarLorebookEntry(lorebook, characterData) {
        const userName = characterData.realName || '{{user}}';

        const initVarContent = `{
  "Áî®Êà∑": {
    "ÂßìÂêç": ["${userName}", "Áî®Êà∑ÁöÑÂßìÂêç„ÄÇËØ∑Âãø‰∏ªÂä®Êõ¥Êñ∞Ê≠§È°πÔºåÈô§ÈùûÁî®Êà∑ÊòéÁ°ÆË¶ÅÊ±Ç‰Ω†Êõ¥Êñ∞"],
    "‰ΩçÁΩÆ": ["Êú™Áü•", "Áî®Êà∑ÂΩìÂâçÊâÄÂú®ÁöÑÂú∞ÁÇπ„ÄÇ"],
    "Ë°£ÁùÄ": ["Êú™Áü•", "Áî®Êà∑ÂΩìÂâçÁöÑÁ©øÁùÄÊèèËø∞„ÄÇ"],
    "Ë°å‰∏∫": ["Êú™Áü•", "ÊèèËø∞Áî®Êà∑ÂΩìÂâçÁöÑ‰∏ªË¶ÅË°å‰∏∫ÊàñÂßøÊÄÅ„ÄÇ"],

    "Ë∫´‰ªΩ": ["${characterData.identity || 'Êú™Áü•'}", "Áî®Êà∑ÂΩìÂâçÁöÑË∫´‰ªΩÔºåËØ∑Ê†πÊçÆÂâßÊÉÖÊõ¥Êñ∞"],
    "ÊÄßÊ¨≤ÂÄº": [0, "ËåÉÂõ¥[0, 100]ÔºåÁî®Êà∑ÁöÑÂΩìÂâçÁîüÁêÜÊ¨≤ÊúõÂº∫Â∫¶„ÄÇÂΩìÁî®Êà∑Â§Ñ‰∫éÊÄßÁà±Âú∫ÊôØÊó∂Ë∑üÈöèÂâßÊÉÖÊõ¥Êñ∞„ÄÇ"],

    "Êó∂Èó¥": ["ÊöÇÊó†", "ÂΩìÂâçÁöÑÊó∂Èó¥,24Â∞èÊó∂Âà∂,ËØ∑Ê†πÊçÆÂâßÊÉÖÂèäÊó∂Êõ¥Êñ∞"],
    "Êó•Êúü": ["ÊöÇÊó†", "ÂΩìÂâçÁöÑÊó•ÊúüÔºåËØ∑Ê†πÊçÆÂâßÊÉÖÂèäÊó∂Êõ¥Êñ∞„ÄÇÂ¶Ç:7/24/2025ÔºåÊàñÁ¨¨‰∏ÄÂ§©"]
  }
}`;

        const initVarEntry = {
          comment: '[InitVar] Áî®Êà∑ÂàùÂßãÔºàËØ∑ÂãøÊâìÂºÄÊàñ‰øÆÊîπÔºâ',
          enabled: false, // ÂÖ≥Èó≠Áä∂ÊÄÅ
          position: 'before_character_definition',
          content: initVarContent,
          keys: ['InitVar', 'Áî®Êà∑ÂàùÂßã'],
          order: 0,
          priority: 1000,
        };

        await createLorebookEntries(lorebook, [initVarEntry]);
      }

      // ÂàõÂª∫Áî®Êà∑‰∫∫ËÆæ‰∏ñÁïå‰π¶Êù°ÁõÆ
      async function createUserProfileLorebookEntry(lorebook, characterData) {
        let profileContent = `#Áî®Êà∑‰∫∫ËÆæ\nÁî®Êà∑ÂßìÂêçÔºö${characterData.realName}„ÄÇ\n\n`;

        // Ê∑ªÂä†Âü∫Êú¨‰ø°ÊÅØ
        if (characterData.age) {
          profileContent += `Âπ¥ÈæÑÔºö${characterData.age}\n`;
        }
        if (characterData.biologicalGender) {
          profileContent += `ÁîüÁêÜÊÄßÂà´Ôºö${characterData.biologicalGender}\n`;
        }
        if (characterData.sexualOrientation) {
          profileContent += `ÊÄßÂèñÂêëÔºö${characterData.sexualOrientation}\n`;
        }

        // Ê∑ªÂä†Ê≠£Èù¢ÊÄßÊ†º
        if (characterData.positiveTraits && characterData.positiveTraits.length > 0) {
          profileContent += `Ê≠£Èù¢ÊÄßÊ†ºÔºö${characterData.positiveTraits.join('„ÄÅ')}\n`;
        }

        // Ê∑ªÂä†Ë¥üÈù¢ÊÄßÊ†º
        if (characterData.negativeTraits && characterData.negativeTraits.length > 0) {
          profileContent += `Ë¥üÈù¢ÊÄßÊ†ºÔºö${characterData.negativeTraits.join('„ÄÅ')}\n`;
        }

        // Ê∑ªÂä†ÊÑüÊÉÖËßÇ
        if (characterData.loveViews && characterData.loveViews.length > 0) {
          profileContent += `ÊÑüÊÉÖËßÇÔºö${characterData.loveViews.join('„ÄÅ')}\n`;
        }

        // Ê∑ªÂä†Á§æ‰∫§È£éÊ†º
        if (characterData.socialStyle && characterData.socialStyle.length > 0) {
          profileContent += `Á§æ‰∫§È£éÊ†ºÔºö${characterData.socialStyle.join('„ÄÅ')}\n`;
        }

        // Ê∑ªÂä†Â§ñË≤åËÆæÂÆö
        if (characterData.height) {
          profileContent += `Ë∫´È´òÔºö${characterData.height}cm\n`;
        }
        if (characterData.weight) {
          profileContent += `‰ΩìÈáçÔºö${characterData.weight}kg\n`;
        }
        if (characterData.face && characterData.face.length > 0) {
          profileContent += `Èù¢Ë≤åÔºö${characterData.face.join('„ÄÅ')}\n`;
        }
        if (characterData.body && characterData.body.length > 0) {
          profileContent += `Ë∫´ÊùêÔºö${characterData.body.join('„ÄÅ')}\n`;
        }
        if (characterData.skinColor) {
          profileContent += `ËÇ§Ëâ≤Ôºö${characterData.skinColor}\n`;
        }
        if (characterData.eyeColor) {
          profileContent += `Áû≥Ëâ≤Ôºö${characterData.eyeColor}\n`;
        }
        if (characterData.facialFeatures) {
          profileContent += `Èù¢ÈÉ®ÁâπÂæÅÔºö${characterData.facialFeatures}\n`;
        }
        if (characterData.hairColor) {
          profileContent += `ÂèëËâ≤Ôºö${characterData.hairColor}\n`;
        }
        if (characterData.hairStyle) {
          profileContent += `ÂèëÂûãÔºö${characterData.hairStyle}\n`;
        }
        if (characterData.dressStyle) {
          profileContent += `Êó•Â∏∏Á©øÊê≠ÂÅèÂ•ΩÔºö${characterData.dressStyle}\n`;
        }
        if (characterData.accessories) {
          profileContent += `Ê†áÂøóÊÄßÈÖçÈ•∞Ôºö${characterData.accessories}\n`;
        }

        // Ê∑ªÂä†ÂÖ∂‰ªñËÆæÂÆö
        if (characterData.illness) {
          profileContent += `ÁóÖÁóáÔºö${characterData.illness}\n`;
        }
        if (characterData.characterTrait) {
          profileContent += `‰∫∫Áâ©ÁâπÁÇπÔºö${characterData.characterTrait}\n`;
        }
        if (characterData.bodyScent) {
          profileContent += `‰ΩìÂë≥Ôºö${characterData.bodyScent}\n`;
        }
        if (characterData.sensitivity) {
          profileContent += `Ë∫´‰ΩìÊïèÊÑüÂ∫¶Ôºö${characterData.sensitivity}\n`;
        }
        if (characterData.sexualHistory) {
          profileContent += `ËøáÂæÄÊÄßÁªèÂéÜÔºö${characterData.sexualHistory}\n`;
        }
        if (characterData.libido) {
          profileContent += `ÊÄßÊ¨≤ÊåáÊï∞Ôºö${characterData.libido}\n`;
        }
        if (characterData.kinks && characterData.kinks.length > 0) {
          profileContent += `ÊÄßÁôñÔºö${characterData.kinks.join('„ÄÅ')}\n`;
        }
        if (characterData.hobbies && characterData.hobbies.length > 0) {
          profileContent += `Áà±Â•ΩÔºö${characterData.hobbies.join('„ÄÅ')}\n`;
        }
        if (characterData.sensitiveSpots && characterData.sensitiveSpots.length > 0) {
          profileContent += `ÊïèÊÑüÁÇπÔºö${characterData.sensitiveSpots.join('„ÄÅ')}\n`;
        }

        // Ê∑ªÂä†ÊÉÖÊÑüÁä∂ÊÄÅ
        if (characterData.relationshipStatus) {
          profileContent += `ËøáÂæÄÊÉÖÊÑüÁä∂ÊÄÅÔºö${characterData.relationshipStatus}\n`;
        }

        // Ê∑ªÂä†Ë∫´‰ªΩ
        if (characterData.identity) {
          profileContent += `ÂàùÂßãË∫´‰ªΩÔºö${characterData.identity}\n`;
        }

        // Ê∑ªÂä†ÂÖ∂‰ªñËá™ÂÆö‰πâ‰ø°ÊÅØ
        if (characterData.additionalInfo) {
          profileContent += `Ë°•ÂÖÖËØ¥ÊòéÔºö${characterData.additionalInfo}\n`;
        }

        const userProfileEntry = {
          comment: 'Áî®Êà∑‰∫∫ËÆæ',
          enabled: true,
          type: 'constant',
          position: 'at_depth_as_system',
          depth: 2,
          content: profileContent,
          keys: ['Áî®Êà∑‰∫∫ËÆæ', characterData.realName],
          order: 100,
          priority: 500,
        };

        await createLorebookEntries(lorebook, [userProfileEntry]);
      }

      // ÂèëÈÄÅÂàùÂßãÊ∂àÊÅØ
      async function sendInitialMessage(characterData) {
        let messageContent = `#Áî®Êà∑‰∫∫ËÆæ\nÁî®Êà∑ÂßìÂêçÔºö${characterData.realName}„ÄÇ\n\n`;

        // Ê∑ªÂä†Áî®Êà∑ÈÄâÊã©ÁöÑÈÄâÈ°π
        if (characterData.age) {
          messageContent += `Âπ¥ÈæÑÔºö${characterData.age}Ôºå`;
        }
        if (characterData.biologicalGender) {
          messageContent += `ÁîüÁêÜÊÄßÂà´Ôºö${characterData.biologicalGender}Ôºå`;
        }
        if (characterData.psychologicalGender) {
          messageContent += `ÂøÉÁêÜËÆ§Áü•ÊÄßÂà´Ôºö${characterData.psychologicalGender}Ôºå`;
        }
        if (characterData.publicGender) {
          messageContent += `ÂØπÂ§ñÂÖ¨ÂºÄÊÄßÂà´Ôºö${characterData.publicGender}Ôºå`;
        }
        if (characterData.sexualOrientation) {
          messageContent += `ÊÄßÂèñÂêëÔºö${characterData.sexualOrientation}Ôºå`;
        }
        if (characterData.positiveTraits && characterData.positiveTraits.length > 0) {
          messageContent += `Ê≠£Èù¢ÊÄßÊ†ºÔºö${characterData.positiveTraits.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.negativeTraits && characterData.negativeTraits.length > 0) {
          messageContent += `Ë¥üÈù¢ÊÄßÊ†ºÔºö${characterData.negativeTraits.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.loveViews && characterData.loveViews.length > 0) {
          messageContent += `ÊÑüÊÉÖËßÇÔºö${characterData.loveViews.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.socialStyle && characterData.socialStyle.length > 0) {
          messageContent += `Á§æ‰∫§È£éÊ†ºÔºö${characterData.socialStyle.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.height) {
          messageContent += `Ë∫´È´òÔºö${characterData.height}cmÔºå`;
        }
        if (characterData.weight) {
          messageContent += `‰ΩìÈáçÔºö${characterData.weight}kgÔºå`;
        }
        if (characterData.face && characterData.face.length > 0) {
          messageContent += `Èù¢Ë≤åÔºö${characterData.face.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.body && characterData.body.length > 0) {
          messageContent += `Ë∫´ÊùêÔºö${characterData.body.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.skinColor) {
          messageContent += `ËÇ§Ëâ≤Ôºö${characterData.skinColor}Ôºå`;
        }
        if (characterData.eyeColor) {
          messageContent += `Áû≥Ëâ≤Ôºö${characterData.eyeColor}Ôºå`;
        }
        if (characterData.facialFeatures) {
          messageContent += `Èù¢ÈÉ®ÁâπÂæÅÔºö${characterData.facialFeatures}Ôºå`;
        }
        if (characterData.hairColor) {
          messageContent += `ÂèëËâ≤Ôºö${characterData.hairColor}Ôºå`;
        }
        if (characterData.hairStyle) {
          messageContent += `ÂèëÂûãÔºö${characterData.hairStyle}Ôºå`;
        }
        if (characterData.dressStyle) {
          messageContent += `Êó•Â∏∏Á©øÊê≠ÂÅèÂ•ΩÔºö${characterData.dressStyle}Ôºå`;
        }
        if (characterData.accessories) {
          messageContent += `Ê†áÂøóÊÄßÈÖçÈ•∞Ôºö${characterData.accessories}Ôºå`;
        }
        if (characterData.illness) {
          messageContent += `ÁóÖÁóáÔºö${characterData.illness}Ôºå`;
        }
        if (characterData.characterTrait) {
          messageContent += `‰∫∫Áâ©ÁâπÁÇπÔºö${characterData.characterTrait}Ôºå`;
        }
        if (characterData.bodyScent) {
          messageContent += `‰ΩìÂë≥Ôºö${characterData.bodyScent}Ôºå`;
        }
        if (characterData.sensitivity) {
          messageContent += `Ë∫´‰ΩìÊïèÊÑüÂ∫¶Ôºö${characterData.sensitivity}Ôºå`;
        }
        if (characterData.sexualHistory) {
          messageContent += `ËøáÂæÄÊÄßÁªèÂéÜÔºö${characterData.sexualHistory}Ôºå`;
        }
        if (characterData.libido) {
          messageContent += `ÊÄßÊ¨≤ÊåáÊï∞Ôºö${characterData.libido}Ôºå`;
        }
        if (characterData.kinks && characterData.kinks.length > 0) {
          messageContent += `ÊÄßÁôñÔºö${characterData.kinks.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.hobbies && characterData.hobbies.length > 0) {
          messageContent += `Áà±Â•ΩÔºö${characterData.hobbies.join('„ÄÅ')}Ôºå`;
        }
        if (characterData.sensitiveSpots && characterData.sensitiveSpots.length > 0) {
          messageContent += `ÊïèÊÑüÁÇπÔºö${characterData.sensitiveSpots.join('„ÄÅ')}Ôºå`;
        }

        if (characterData.additionalInfo) {
          messageContent += `Ë°•ÂÖÖËØ¥ÊòéÔºö${characterData.additionalInfo}Ôºå`;
        }

        // ÁßªÈô§ÊúÄÂêéÁöÑÈÄóÂè∑
        messageContent = messageContent.replace(/Ôºå$/, '');

        const chatMessage = {
          role: 'user',
          message: messageContent,
          send_date: '',
        };

        try {
          window.parent.document.querySelector('#send_textarea').value = messageContent;
          //window.parent.document.querySelector('#send_but').click();
        } catch (error) {
          alert('Êó†Ê≥ïËá™Âä®ÂèëÈÄÅ„ÄÇËßíËâ≤‰ø°ÊÅØÂ∑≤ËæìÂá∫Âà∞ÊéßÂà∂Âè∞ÔºåËØ∑ÊâãÂä®Â§çÂà∂„ÄÇ');
        }
      }

      // Êî∂ÈõÜË°®ÂçïÊï∞ÊçÆ
      function collectFormData() {
        const data = {
          // Âü∫Êú¨‰ø°ÊÅØ
          realName: document.getElementById('realName').value,
          age: document.getElementById('age').value,
          biologicalGender: document.getElementById('biologicalGender').value,
          sexualOrientation: document.getElementById('sexualOrientation').value,

          // ÊÄßÊ†ºÁâπÂæÅ
          positiveTraits: getSelectedOptions('positiveTraitsGrid'),
          negativeTraits: getSelectedOptions('negativeTraitsGrid'),
          loveViews: getSelectedOptions('loveViewsGrid'),
          socialStyle: getSelectedOptions('socialStyleGrid'),

          // Â§ñË≤åËÆæÂÆö
          height: document.getElementById('height').value,
          weight: document.getElementById('weight').value,
          face: getSelectedOptions('faceGrid'),
          body: getSelectedOptions('bodyGrid'),
          skinColor: document.getElementById('skinColor').value,
          eyeColor: document.getElementById('eyeColor').value,
          facialFeatures: document.getElementById('facialFeatures').value,
          hairColor: document.getElementById('hairColor').value,
          hairStyle: document.getElementById('hairStyle').value,
          dressStyle: document.getElementById('dressStyle').value,
          accessories: document.getElementById('accessories').value,

          // ÂÖ∂‰ªñËÆæÂÆö
          illness: document.getElementById('illness').value,
          characterTrait: document.getElementById('characterTrait').value,
          bodyScent: document.getElementById('bodyScent').value,
          sensitivity: document.getElementById('sensitivity').value,
          sexualHistory: document.getElementById('sexualHistory').value,
          libido: document.getElementById('libido').value,
          kinks: getSelectedOptions('kinksGrid'),
          hobbies: getSelectedOptions('hobbiesGrid'),
          sensitiveSpots: getSelectedOptions('sensitiveSpotsGrid'),

          // ÂÖ∂‰ªñ
          additionalInfo: document.getElementById('additionalInfo').value,

          // ÁªèÂéÜ
          identity: getSelectedSingleOption('identityGrid'),
          relationshipStatus: getSelectedSingleOption('relationshipStatusGrid'),
        };

        // Â§ÑÁêÜËá™ÂÆö‰πâËæìÂÖ• - ÂêàÂπ∂ËÄå‰∏çÊòØÊõøÊç¢
        Object.keys(data).forEach(key => {
          const customInput = document.getElementById(key + 'Custom');
          if (customInput && customInput.value.trim()) {
            if (Array.isArray(data[key])) {
              // ÂØπ‰∫éÊï∞ÁªÑÁ±ªÂûãÔºåÂêàÂπ∂ÈÄâÈ°πÂíåËá™ÂÆö‰πâËæìÂÖ•
              const customItems = customInput.value
                .split(',')
                .map(s => s.trim())
                .filter(s => s);
              data[key] = [...data[key], ...customItems];
            } else {
              // ÂØπ‰∫éÂçïÈÄâÁ±ªÂûãÔºåÂ¶ÇÊûúÊ≤°ÊúâÈÄâÊã©ÈÄâÈ°πÔºåÂàô‰ΩøÁî®Ëá™ÂÆö‰πâËæìÂÖ•
              if (!data[key] || data[key] === '') {
                data[key] = customInput.value.trim();
              }
            }
          }
        });

        return data;
      }

      // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÈÄâÈ°π
      function getSelectedOptions(gridId) {
        const grid = document.getElementById(gridId);
        if (!grid) return [];

        const selectedBtns = grid.querySelectorAll('.option-btn.selected');
        return Array.from(selectedBtns).map(btn => btn.getAttribute('data-value'));
      }

      // Ëé∑ÂèñÂçïÈÄâÈÄâÈ°π
      function getSelectedSingleOption(gridId) {
        const grid = document.getElementById(gridId);
        if (!grid) return '';

        const selectedBtn = grid.querySelector('.option-btn.selected');
        return selectedBtn ? selectedBtn.getAttribute('data-value') : '';
      }

      // ÂÖ≥Èó≠Ê®°ÊÄÅÁ™óÂè£ÁöÑÂáΩÊï∞
      function closeYamlModal() {
        const modal = document.getElementById('yamlModal');
        
        if (!modal) {
          return;
        }
        
        // Ê∑ªÂä†Ê∑°Âá∫Âä®Áîª
        modal.style.transition = 'opacity 0.3s ease-in-out';
        modal.style.opacity = '0';
        
        // Âä®ÁîªÂÆåÊàêÂêéÈöêËóè
        setTimeout(() => {
          modal.style.display = 'none';
          modal.style.transition = '';
        }, 300);
      }

      // ÂÆâÂÖ®ÁöÑ‰∫ã‰ª∂ÁªëÂÆöÂáΩÊï∞
      function bindModalEvents(modal) {
        
        if (!modal) {
          return;
        }
        
        try {
          // ËÉåÊôØÁÇπÂáªÂÖ≥Èó≠
          modal.addEventListener('click', function(e) {
            if (e.target === modal) {
              closeYamlModal();
            }
          });
          
          // ÂÖ≥Èó≠ÊåâÈíÆÁÇπÂáª
          const closeBtn = modal.querySelector('.yaml-modal-close');
          
          if (closeBtn) {
            closeBtn.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              closeYamlModal();
            });
          }
          
          // ESCÈîÆÂÖ≥Èó≠
          const escHandler = function(e) {
            if (e.key === 'Escape' && modal.style.display === 'block') {
              closeYamlModal();
            }
          };
          document.addEventListener('keydown', escHandler);
          
        } catch (error) {
          // ÈùôÈªòÂ§ÑÁêÜÈîôËØØ
        }
      }

      // ===== Êâ©Â±ïÊÄßAPIÂáΩÊï∞ =====
      
      /**
       * Âä®ÊÄÅÊ∑ªÂä†Êñ∞ÁöÑÈÄâÈ°πÁªÑ
       * @param {string} groupName - ÈÄâÈ°πÁªÑÂêçÁß∞
       * @param {Object} config - ÈÄâÈ°πÁªÑÈÖçÁΩÆ
       * @param {string} config.type - ÈÄâÈ°πÁ±ªÂûã ('multi-select' Êàñ 'single-select')
       * @param {boolean} config.genderFilter - ÊòØÂê¶ÊåâÊÄßÂà´Á≠õÈÄâ
       * @param {Array|Object} config.options - ÈÄâÈ°πÂàóË°®ÊàñÊÄßÂà´ÂàÜÁªÑÁöÑÈÄâÈ°π
       */
      function addOptionGroup(groupName, config) {
        try {
          OPTIONS_CONFIG[groupName] = config;
          
          // Â¶ÇÊûúÈ°µÈù¢Â∑≤Âä†ËΩΩÔºåÁ´ãÂç≥Êõ¥Êñ∞ÂØπÂ∫îÁöÑÁΩëÊ†º
          if (document.readyState === 'complete') {
            const grid = document.getElementById(groupName + 'Grid');
            if (grid) {
              updateOptionsGrid(groupName, getCurrentGender());
            }
          }
        } catch (error) {
          // ÈùôÈªòÂ§ÑÁêÜÈîôËØØ
        }
      }

      /**
       * Êõ¥Êñ∞Áé∞ÊúâÈÄâÈ°πÁªÑÁöÑÈÄâÈ°π
       * @param {string} groupName - ÈÄâÈ°πÁªÑÂêçÁß∞  
       * @param {Array|Object} newOptions - Êñ∞ÁöÑÈÄâÈ°πÂàóË°®
       */
      function updateOptionGroup(groupName, newOptions) {
        try {
          if (OPTIONS_CONFIG[groupName]) {
            OPTIONS_CONFIG[groupName].options = newOptions;
            
            // Á´ãÂç≥Âà∑Êñ∞ÂØπÂ∫îÁöÑÁΩëÊ†º
            const grid = document.getElementById(groupName + 'Grid');
            if (grid) {
              updateOptionsGrid(groupName, getCurrentGender());
            }
          }
        } catch (error) {
          // ÈùôÈªòÂ§ÑÁêÜÈîôËØØ
        }
      }

      /**
       * ÈáçÊñ∞ÂàùÂßãÂåñÊâÄÊúâÈÄâÈ°πÁªÑ
       */
      function initializeAllOptionGroups() {
        try {
          // Ëé∑ÂèñÂΩìÂâçÊÄßÂà´
          const currentGender = getCurrentGender();
          
          // ÈáçÊñ∞ÂàùÂßãÂåñÊâÄÊúâÈÄâÈ°πÁªÑ
          Object.keys(CHARACTER_OPTIONS_CONFIG).forEach(groupName => {
            const config = CHARACTER_OPTIONS_CONFIG[groupName];
            if (config && config.type === 'multi-select') {
              updateOptionsGrid(groupName, currentGender);
            }
          });
          
          // ÈáçÊñ∞ÂàùÂßãÂåñÊÄßÂà´ÂíåË∫´‰ªΩ‰∏ãÊãâÊ°Ü
          initializeGenderOptions();
          initializeIdentityOptions();
          
        } catch (error) {
          console.warn('ÈáçÊñ∞ÂàùÂßãÂåñÈÄâÈ°πÁªÑÊó∂Âá∫Èîô:', error);
        }
      }

      /**
       * ÂàùÂßãÂåñÊÄßÂà´ÈÄâÈ°π
       */
      function initializeGenderOptions() {
        const genderSelect = document.getElementById('biologicalGender');
        if (genderSelect && UNIVERSAL_SEXUAL_OPTIONS.biologicalGender) {
          updateSelectOptions('biologicalGender', UNIVERSAL_SEXUAL_OPTIONS.biologicalGender);
        }
      }

      /**
       * ÂàùÂßãÂåñË∫´‰ªΩÈÄâÈ°π
       */
      function initializeIdentityOptions() {
        const world = WORLDS_CONFIG[currentWorld];
        if (world && world.identity && world.identity.options) {
          updateSelectOptions('identity', world.identity.options);
        }
      }

      /**
       * ÁßªÈô§ÈÄâÈ°πÁªÑ
       * @param {string} groupName - Ë¶ÅÁßªÈô§ÁöÑÈÄâÈ°πÁªÑÂêçÁß∞
       */
      function removeOptionGroup(groupName) {
        try {
          if (OPTIONS_CONFIG[groupName]) {
            delete OPTIONS_CONFIG[groupName];
            
            // Ê∏ÖÁ©∫ÂØπÂ∫îÁöÑÁΩëÊ†º
            const grid = document.getElementById(groupName + 'Grid');
            if (grid) {
              grid.innerHTML = '<!-- ÈÄâÈ°πÁªÑÂ∑≤ÁßªÈô§ -->';
            }
          }
        } catch (error) {
          // ÈùôÈªòÂ§ÑÁêÜÈîôËØØ
        }
      }

      /**
       * Ëé∑ÂèñÂΩìÂâçÊâÄÊúâÈÄâÈ°πÁªÑÁöÑÈÖçÁΩÆ
       * @returns {Object} ÊâÄÊúâÈÄâÈ°πÁªÑÈÖçÁΩÆÁöÑÂâØÊú¨
       */
      function getAllOptionGroups() {
        return JSON.parse(JSON.stringify(OPTIONS_CONFIG));
      }

      /**
       * Ëé∑ÂèñÁâπÂÆöÈÄâÈ°πÁªÑÁöÑÈÖçÁΩÆ
       * @param {string} groupName - ÈÄâÈ°πÁªÑÂêçÁß∞
       * @returns {Object|null} ÈÄâÈ°πÁªÑÈÖçÁΩÆÁöÑÂâØÊú¨Ôºå‰∏çÂ≠òÂú®ÂàôËøîÂõûnull
       */
      function getOptionGroup(groupName) {
        if (CHARACTER_OPTIONS_CONFIG[groupName]) {
          return JSON.parse(JSON.stringify(CHARACTER_OPTIONS_CONFIG[groupName]));
        }
        return null;
      }

      // Â∞ÜAPIÂáΩÊï∞Êö¥Èú≤Âà∞ÂÖ®Â±Ä‰ΩúÁî®ÂüüÔºåÊñπ‰æøÂ§ñÈÉ®Ë∞ÉÁî®
      window.CharacterGeneratorAPI = {
        addOptionGroup,
        updateOptionGroup, 
        removeOptionGroup,
        getAllOptionGroups,
        getOptionGroup,
        // ‰πüÊö¥Èú≤‰∏Ä‰∫õÊ†∏ÂøÉÂáΩÊï∞
        updateOptionsGrid,
        getRandomOptions,
        getOptionsByGender
      };

      // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÁöÑÂàùÂßãÂåñ
      document.addEventListener('DOMContentLoaded', function () {
        
        // ËÆæÁΩÆËá™ÂÆö‰πâËæìÂÖ•Ê°ÜÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
        setupCustomInputListeners();

        // Ê∑ªÂä†ÊÄßÂà´ÂèòÂåñÁõëÂê¨Âô®
        const biologicalGenderSelect = document.getElementById('biologicalGender');
        if (biologicalGenderSelect) {
          biologicalGenderSelect.addEventListener('change', function() {
            const currentGender = this.value;
            // ÂΩìÊÄßÂà´ÂèòÂåñÊó∂ÔºåÊõ¥Êñ∞ÊâÄÊúâÊÄßÂà´ÁâπÂÆöÁöÑÈÄâÈ°πÁΩëÊ†º
            Object.keys(CHARACTER_OPTIONS_CONFIG).forEach(fieldName => {
              const config = CHARACTER_OPTIONS_CONFIG[fieldName];
              if (config && config.genderSpecific) {
                updateOptionsGrid(fieldName, currentGender);
              }
            });
            
            // ÂêåÊó∂Êõ¥Êñ∞ÊÄßÂà´ÁâπÂÆöÁöÑ‰∏ãÊãâÊ°ÜÈÄâÈ°π
            updateGenderSpecificSelects(currentGender);
          });
        }

        // ÂàùÂßãÂåñÂä®ÊÄÅÈÄâÈ°πÁΩëÊ†º
        try {
          Object.keys(CHARACTER_OPTIONS_CONFIG).forEach(fieldName => {
            updateOptionsGrid(fieldName, getCurrentGender());
          });
        } catch (error) {
          // ÈùôÈªòÂ§ÑÁêÜÈîôËØØ
        }

        // È™åËØÅÂÖ≥ÈîÆÂÖÉÁ¥†ÊòØÂê¶Â≠òÂú®
        const yamlModal = document.getElementById('yamlModal');
        const yamlOutput = document.getElementById('yamlOutput');
        const copyBtn = document.getElementById('copyYamlBtn');

        // ÁªëÂÆöÊ®°ÊÄÅÁ™óÂè£‰∫ã‰ª∂
        if (yamlModal) {
          bindModalEvents(yamlModal);
        }

        // Â§çÂà∂ÊåâÈíÆ
        if (copyBtn) {
          copyBtn.addEventListener('click', function(e) {
            e.stopPropagation(); // Èò≤Ê≠¢‰∫ã‰ª∂ÂÜíÊ≥°Âà∞Ê®°ÊÄÅÁ™óÂè£
            copyYamlToClipboard();
          });
        }
      });

      // ÊòæÁ§∫YAMLÊ®°ÊÄÅÁ™óÂè£
      function showYamlModal(yamlData) {
        
        const modal = document.getElementById('yamlModal');
        const output = document.getElementById('yamlOutput');
        
        if (!modal) {
          alert('Á≥ªÁªüÈîôËØØÔºöÊâæ‰∏çÂà∞YAMLÊòæÁ§∫Á™óÂè£');
          return;
        }
        
        if (!output) {
          alert('Á≥ªÁªüÈîôËØØÔºöÊâæ‰∏çÂà∞YAMLËæìÂá∫Âå∫Âüü');
          return;
        }
        
        try {
          const yamlString = jsyaml.dump(yamlData, {indent: 2, lineWidth: 120});
          
          output.value = yamlString;
          
          // Á°Æ‰øùÊ®°ÊÄÅÁ™óÂè£ÂèØËßÅ
          modal.style.display = 'block';
          modal.style.opacity = '0';
          
          // ‰ΩøÁî®requestAnimationFrameÁ°Æ‰øùDOMÊõ¥Êñ∞ÂêéÂÜçÊòæÁ§∫Âä®Áîª
          requestAnimationFrame(() => {
            modal.style.transition = 'opacity 0.3s ease-in-out';
            modal.style.opacity = '1';
          });
          
          // ËÅöÁÑ¶Âà∞ËæìÂá∫Âå∫Âüü‰ª•‰æøÁî®Êà∑ÂèØ‰ª•Áõ¥Êé•Êìç‰Ωú
          setTimeout(() => {
            output.focus();
          }, 100);
          
        } catch (error) {
          alert('Á≥ªÁªüÈîôËØØÔºöÊó†Ê≥ïÁîüÊàêYAMLÊï∞ÊçÆ - ' + error.message);
        }
      }

      // Â§çÂà∂YAMLÂà∞Ââ™Ë¥¥Êùø
      async function copyYamlToClipboard() {
        
        const output = document.getElementById('yamlOutput');
        if (!output) {
          alert('Á≥ªÁªüÈîôËØØÔºöÊâæ‰∏çÂà∞YAMLËæìÂá∫Âå∫Âüü');
          return;
        }
        
        const textToCopy = output.value.trim();
        if (!textToCopy) {
          alert('Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑYAMLÊï∞ÊçÆ');
          return;
        }
        
        // ÊñπÊ≥ï1: Áé∞‰ª£ÊµèËßàÂô® Clipboard API
        if (navigator.clipboard && window.isSecureContext) {
          try {
            await navigator.clipboard.writeText(textToCopy);
            alert('YAMLÊï∞ÊçÆÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
            return;
          } catch (err) {
            // ÁªßÁª≠Â∞ùËØïÂÖ∂‰ªñÊñπÊ≥ï
          }
        }
        
        // ÊñπÊ≥ï2: ‰º†Áªü execCommand ÊñπÊ≥ï
        try {
          output.select();
          output.setSelectionRange(0, 99999);
          const successful = document.execCommand('copy');
          
          if (successful) {
            alert('YAMLÊï∞ÊçÆÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅ');
            return;
          }
        } catch (err) {
          // ÁªßÁª≠Âà∞ÊñπÊ≥ï3
        }
        
        // ÊñπÊ≥ï3: ÊâãÂä®Â§çÂà∂ÊèêÁ§∫
        output.focus();
        output.select();
        alert('Ëá™Âä®Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂„ÄÇÂ∑≤‰∏∫ÊÇ®ÈÄâ‰∏≠ÊñáÊú¨ÔºåËØ∑Êåâ Ctrl+C (Mac: Cmd+C)');
      }
    </script>
  </body>
</html>